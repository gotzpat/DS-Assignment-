<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-17">

<title>Predicting Student Dropout and Academic Success</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="report_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="report_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap-a74871fe4945b66d259aafc266475145.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #0095C8;
      }
</style>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Predicting Student Dropout and Academic Success</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Patricia Götz </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              University of Lausanne
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Lana Kabbani </p>
    </div>
    <div class="quarto-title-meta-contents">
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Noémie Glaus </p>
    </div>
    <div class="quarto-title-meta-contents">
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Estela Gonzalez Vizcarra </p>
    </div>
    <div class="quarto-title-meta-contents">
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 17, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. - Introduction</a></li>
  <li><a href="#background-and-motivation" id="toc-background-and-motivation" class="nav-link" data-scroll-target="#background-and-motivation">1.1 - Background and Motivation</a></li>
  <li><a href="#project-goals" id="toc-project-goals" class="nav-link" data-scroll-target="#project-goals">1.2 - Project Goals</a></li>
  <li><a href="#i.3---research-questions" id="toc-i.3---research-questions" class="nav-link" data-scroll-target="#i.3---research-questions">I.3 - Research Questions</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">2. - Data</a></li>
  <li><a href="#data-sourcing" id="toc-data-sourcing" class="nav-link" data-scroll-target="#data-sourcing">2.1 - Data Sourcing</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">2.2 - Data Description</a></li>
  <li><a href="#data-loading" id="toc-data-loading" class="nav-link" data-scroll-target="#data-loading">2.2.1 - Data Loading</a></li>
  <li><a href="#variable-selection" id="toc-variable-selection" class="nav-link" data-scroll-target="#variable-selection">2.2.2 - Variable Selection</a></li>
  <li><a href="#variable-descriptions" id="toc-variable-descriptions" class="nav-link" data-scroll-target="#variable-descriptions">2.2.3 - Variable Descriptions</a></li>
  <li><a href="#preprocessing-data-cleaning-and-wrangling" id="toc-preprocessing-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#preprocessing-data-cleaning-and-wrangling">3. Preprocessing (Data Cleaning and Wrangling)</a></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">4. - Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#target-variable" id="toc-target-variable" class="nav-link" data-scroll-target="#target-variable">4.1 - Target Variable</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">4.2 - Correlation Analysis</a></li>
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection">4.3 - Feature Selection</a></li>
  <li><a href="#outlier-detection" id="toc-outlier-detection" class="nav-link" data-scroll-target="#outlier-detection">4.4 - Outlier Detection</a>
  <ul>
  <li><a href="#outlier-summary" id="toc-outlier-summary" class="nav-link" data-scroll-target="#outlier-summary">4.5 - Outlier Summary</a></li>
  </ul></li>
  <li><a href="#feature-importance-analysis" id="toc-feature-importance-analysis" class="nav-link" data-scroll-target="#feature-importance-analysis">4.6 - Feature Importance Analysis</a>
  <ul>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">4.6.1 - Methodology</a></li>
  </ul></li>
  <li><a href="#top-predictive-variables" id="toc-top-predictive-variables" class="nav-link" data-scroll-target="#top-predictive-variables">4.7 - Top Predictive Variables</a>
  <ul>
  <li><a href="#acadamic-performance-indicators" id="toc-acadamic-performance-indicators" class="nav-link" data-scroll-target="#acadamic-performance-indicators">4.7.1 - Acadamic Performance Indicators</a></li>
  <li><a href="#key-findings-academic-performance-and-study-conditions" id="toc-key-findings-academic-performance-and-study-conditions" class="nav-link" data-scroll-target="#key-findings-academic-performance-and-study-conditions">4.7.2 - Key Findings: Academic Performance and Study Conditions</a></li>
  <li><a href="#demographic-socioeconomic-background" id="toc-demographic-socioeconomic-background" class="nav-link" data-scroll-target="#demographic-socioeconomic-background">4.7.3 Demographic &amp; Socioeconomic Background</a></li>
  <li><a href="#predictive-modelling" id="toc-predictive-modelling" class="nav-link" data-scroll-target="#predictive-modelling">4.8 - Predictive Modelling</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. - Introduction</h2>
<p>This analysis examines data from a Portuguese higher education institution to identify factors that contribute to student dropout and academic success. The dataset contains information on 4,424 students enrolled across various undergraduate programs.</p>
</section>
<section id="background-and-motivation" class="level2">
<h2 class="anchored" data-anchor-id="background-and-motivation">1.1 - Background and Motivation</h2>
<p>Student retention and academic success are crucial issues for higher education institutions. Universities increasingly rely on data-driven insights to identify at-risk students and to design early intervention strategies. We chose this topic because predicting student dropout not only helps optimize institutional resources but also supports students in achieving their academic goals. Understanding the factors that influence academic success, such as socio-economic background, previous academic performance, or family situation, can improve educational policies and personalized support systems. This subject is particularly meaningful in data science, because we can combine analytical and predictive methods to better understand and prevent student dropout.</p>
</section>
<section id="project-goals" class="level2">
<h2 class="anchored" data-anchor-id="project-goals">1.2 - Project Goals</h2>
<p>The main objective of this project is to identify the factors that influence students to drop out, stay enrolled, or graduate from higher education. The dataset provides detailed information on each student’s academic performance, socioeconomic background, and demographic profile, offering a comprehensive view of the variables that shape educational outcomes. By the end of our analysis, we seek to identify the most significant combinations of academic and personal factors that influence student success. First, our analysis will focus on academic performance, examining how variables such as admission grades, semester evaluations, and course results relate to final outcomes. For instance, we will analyze whether early academic performance can serve as a reliable predictor of future dropout risk. We will then explore the influence of socioeconomic and personal factors, including parental education, occupation, and financial situation, to understand their impact on academic achievement. Lastly, the dataset will be used to build and evaluate classification models that predict students’ academic status (Dropout, Enrolled, or Graduate). In summary, this study combines exploratory analysis, visualization, and predictive modeling to generate actionable insights that help universities detect at-risk students early and strengthen academic success.</p>
</section>
<section id="i.3---research-questions" class="level2">
<h2 class="anchored" data-anchor-id="i.3---research-questions">I.3 - Research Questions</h2>
<ul>
<li><ol type="I">
<li>How do academic performance indicators and study conditions influence students’ likelihood of graduation or dropout?</li>
</ol></li>
<li><ol start="2" type="I">
<li>What is the impact of demographic and socioeconomic background on students’ probability of dropping out?</li>
</ol></li>
<li><ol start="3" type="I">
<li>Can we accurately predict a student’s final status (Dropout, Enrolled, or Graduate) based on their demographic, socioeconomic, and academic characteristics. Which are the most relevant among them?</li>
</ol></li>
</ul>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">2. - Data</h2>
</section>
<section id="data-sourcing" class="level2">
<h2 class="anchored" data-anchor-id="data-sourcing">2.1 - Data Sourcing</h2>
<p>The dataset is publicly available on UCI Machine Learning Repository and was created from multiple databases of higher education institutions in Portugal. It is related to enrolled students in different undergraduate programs and shows how different demographic, socioeconomic and academic factors are related to the dropout. Since the data has already been collected and can be directly downloaded from <a href="https://archive.ics.uci.edu/dataset/697/predict%2Bstudents%2Bdropout%2Band%2Bacademic%2Bsuccess" target="_blank">UCI MLR - Predict Students’ Dropout and Academic Success</a> - [Accessed on 20th October] , there is no need to collect more data via webscraping or APIs.</p>
</section>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">2.2 - Data Description</h2>
<p>The dataset, containing data from a Portuguese higher education institution, is provided as a CSV file, approximately 520 KB in size, and contains detailed information about students’demographic, academic and socio-economic characteristics. It includes 4424 student records and 37 variables (features). After reviewing the dataset variables, we removed two irrelevant ones, resulting in 35 relevant variables selected for analysis.</p>
<p>We didn’t encounter any difficult challenges. The dataset was already clean and encoded, so we didn’t need to perform variable merging, one-hot encoding or ordinal encoding. We only had to translate categorical variables into readable labels to facilitate our visualization analysis.</p>
</section>
<section id="data-loading" class="level2">
<h2 class="anchored" data-anchor-id="data-loading">2.2.1 - Data Loading</h2>
<div id="setup" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ucimlrepo <span class="im">import</span> fetch_ucirepo</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> fetch_ucirepo(<span class="bu">id</span><span class="op">=</span><span class="dv">697</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(dataset.data.features)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(dataset.data.targets)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> dataset.variables[<span class="st">"name"</span>]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.column_stack((X, y)), columns<span class="op">=</span>col_names)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset shape: (4424, 37)</code></pre>
</div>
</div>
<hr>
</section>
<section id="variable-selection" class="level2">
<h2 class="anchored" data-anchor-id="variable-selection">2.2.2 - Variable Selection</h2>
<p>We selected 35 relevant variables for analysis:</p>
<div id="variable-selection" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> [ </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marital Status"</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Application order"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Course"</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daytime/evening attendance"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Previous qualification"</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Previous qualification (grade)"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nacionality"</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mother's qualification"</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Father's qualification"</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mother's occupation"</span>, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Father's occupation"</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Admission grade"</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Educational special needs"</span>, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gender"</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scholarship holder"</span>, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Age at enrollment"</span>, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Displaced"</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Debtor"</span>, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"International"</span>, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (credited)"</span>, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (enrolled)"</span>, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (evaluations)"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (approved)"</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (grade)"</span>, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (without evaluations)"</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (credited)"</span>, </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (enrolled)"</span>, </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (evaluations)"</span>, </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (approved)"</span>, </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (grade)"</span>, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (without evaluations)"</span>, </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unemployment rate"</span>, </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Inflation rate"</span>, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GDP"</span>, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Target"</span>, </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[selected_columns].copy()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Selected </span><span class="sc">{</span><span class="bu">len</span>(selected_columns)<span class="sc">}</span><span class="ss"> variables"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Selected 35 variables</code></pre>
</div>
</div>
</section>
<section id="variable-descriptions" class="level2">
<h2 class="anchored" data-anchor-id="variable-descriptions">2.2.3 - Variable Descriptions</h2>
<div id="cell-variable-descriptions" class="cell" data-execution_count="3">
<div id="variable-descriptions" class="cell-output cell-output-display cell-output-markdown">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 39%">
<col style="width: 40%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Marital Status</td>
<td style="text-align: left;">Student marital status</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Application order</td>
<td style="text-align: left;">Application preference order</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Course</td>
<td style="text-align: left;">Course taken by student</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Daytime/evening attendance</td>
<td style="text-align: left;">Attendance type (daytime or evening)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous qualification</td>
<td style="text-align: left;">Type of previous qualification</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous qualification (grade)</td>
<td style="text-align: left;">Grade of previous qualification</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nacionality</td>
<td style="text-align: left;">Student nationality</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mother’s qualification</td>
<td style="text-align: left;">Educational qualification of mother</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Father’s qualification</td>
<td style="text-align: left;">Educational qualification of father</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mother’s occupation</td>
<td style="text-align: left;">Occupation of mother</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Father’s occupation</td>
<td style="text-align: left;">Occupation of father</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Admission grade</td>
<td style="text-align: left;">Admission grade to the program</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational special needs</td>
<td style="text-align: left;">Whether student has special educational needs</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gender</td>
<td style="text-align: left;">Student gender</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Scholarship holder</td>
<td style="text-align: left;">Whether student is scholarship holder</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at enrollment</td>
<td style="text-align: left;">Age of student at enrollment</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Displaced</td>
<td style="text-align: left;">Whether student is displaced from home</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Debtor</td>
<td style="text-align: left;">Whether student is a debtor</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="odd">
<td style="text-align: left;">International</td>
<td style="text-align: left;">Whether student is international</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 1st sem (credited)</td>
<td style="text-align: left;">Credited units in 1st semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 1st sem (enrolled)</td>
<td style="text-align: left;">Enrolled units in 1st semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 1st sem (evaluations)</td>
<td style="text-align: left;">Number of evaluations in 1st semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 1st sem (approved)</td>
<td style="text-align: left;">Approved units in 1st semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 1st sem (grade)</td>
<td style="text-align: left;">Average grade in 1st semester</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 1st sem (without evaluations)</td>
<td style="text-align: left;">Units without evaluations in 1st semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 2nd sem (credited)</td>
<td style="text-align: left;">Credited units in 2nd semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 2nd sem (enrolled)</td>
<td style="text-align: left;">Enrolled units in 2nd semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 2nd sem (evaluations)</td>
<td style="text-align: left;">Number of evaluations in 2nd semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 2nd sem (approved)</td>
<td style="text-align: left;">Approved units in 2nd semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Curricular units 2nd sem (grade)</td>
<td style="text-align: left;">Average grade in 2nd semester</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Curricular units 2nd sem (without evaluations)</td>
<td style="text-align: left;">Units without evaluations in 2nd semester</td>
<td style="text-align: left;">Numerical (Discrete)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployment rate</td>
<td style="text-align: left;">Unemployment rate at time of enrollment</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inflation rate</td>
<td style="text-align: left;">Inflation rate at time of enrollment</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP</td>
<td style="text-align: left;">GDP at time of enrollment</td>
<td style="text-align: left;">Numerical (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Target</td>
<td style="text-align: left;">Student status (Dropout, Enrolled, or Graduate)</td>
<td style="text-align: left;">Categorical</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Through this step, we didn’t encounter any difficult challenges. The dataset was already clean and encoded, so we didn’t need to perform variable merging, one-hot encoding or ordinal encoding. We only had to convert categorical variables into readable labels to facilitate our visualization analysis.</p>
<hr>
</section>
<section id="preprocessing-data-cleaning-and-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing-data-cleaning-and-wrangling">3. Preprocessing (Data Cleaning and Wrangling)</h2>
<p>One of the most important steps in our project is data cleaning and wrangling. After running the code to check for missing values and undefined numerical data, we found that the dataset contains no missing values, no mistakes and no data entry mistakes.</p>
<p>The dataset was already encoded, and we removed “Application mode” and “Tuition fees up to date” variables because they are not relevant to our research questions. Therefore we dropped two columns from the dataset. Ensuring that the numeric columns are numeric, categorical variables such as “Gender”, “Debtor”, “Displaced” , “Daytime/Evening attendance” were translated to readable string labels for analysis. Although we had a well-structured and clean dataset, our main challenge was to determine the reliability of our dataset. We verified if there were any missing values, spotting mistakes, and determined irrelevant variables for our analysis. We pursue our cleaning work with the conversion of the categorical variables. Therefore, the reliable dataset was ready to be analyzed.</p>
<div id="data-cleaning" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_dataframe(df, col_missing_thresh<span class="op">=</span><span class="fl">0.30</span>, row_missing_thresh<span class="op">=</span><span class="fl">0.50</span>):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Clean dataset with missing value handling."""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count number of NaNs</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    missing <span class="op">=</span> df.isna().<span class="bu">sum</span>()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    missing_data <span class="op">=</span> missing[missing <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(missing_data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">⚠️  Missing values found in </span><span class="sc">{</span><span class="bu">len</span>(missing_data)<span class="sc">}</span><span class="ss"> columns (</span><span class="sc">{</span>missing_data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,}</span><span class="ss"> total)</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        display(missing_data.to_frame(<span class="st">'Count'</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✓ No missing values found!"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Shape after cleaning: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Missing values: </span><span class="sc">{</span>df<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop columns with excessive missing</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    col_frac <span class="op">=</span> df.isna().mean()</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    drop_cols <span class="op">=</span> col_frac[col_frac <span class="op">&gt;</span> col_missing_thresh].index.tolist()</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> drop_cols:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        df.drop(columns<span class="op">=</span>drop_cols, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop rows with excessive missing</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    row_frac <span class="op">=</span> df.isna().mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    drop_rows <span class="op">=</span> row_frac[row_frac <span class="op">&gt;</span> row_missing_thresh].index</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(drop_rows):</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.drop(index<span class="op">=</span>drop_rows).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coerce numeric types</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> s: pd.to_numeric(s, errors<span class="op">=</span><span class="st">"ignore"</span>))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Impute missing values</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[np.number]).columns:</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df[col].isna().<span class="bu">any</span>():</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>            df[col] <span class="op">=</span> df[col].fillna(df[col].median())</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">"category"</span>,<span class="st">"object"</span>]).columns:</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df[col].isna().<span class="bu">any</span>():</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> df[col].mode(dropna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> mode.empty:</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                df[col] <span class="op">=</span> df[col].fillna(mode.iloc[<span class="dv">0</span>])</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> clean_dataframe(df)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape after cleaning: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Missing values: </span><span class="sc">{</span>df<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
✓ No missing values found!

Shape after cleaning: (4424, 35)
Missing values: 0
Shape after cleaning: (4424, 35)
Missing values: 0</code></pre>
</div>
</div>
<p>Although we had a well-structured and clean dataset, our main challenge was to determine the reliability of our dataset. We verified if there were any missing values, spotting mistakes, and determined irrelevant variables for our analysis. We pursue our cleaning work with the conversion of the categorical variables. Therefore, the reliable dataset was ready to be analyzed.</p>
<hr>
</section>
<section id="exploratory-data-analysis-eda" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-eda">4. - Exploratory Data Analysis (EDA)</h2>
<hr>
</section>
<section id="target-variable" class="level2">
<h2 class="anchored" data-anchor-id="target-variable">4.1 - Target Variable</h2>
<div id="cell-target-distribution" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode target</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>target_col <span class="op">=</span> <span class="st">"Target"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df[target_col] <span class="op">=</span> df[target_col].replace({</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">"Dropout"</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">"Enrolled"</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">"Graduate"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df[target_col] <span class="op">=</span> pd.Categorical(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    df[target_col], </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>[<span class="st">"Dropout"</span>, <span class="st">"Enrolled"</span>, <span class="st">"Graduate"</span>], </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>target_counts <span class="op">=</span> df[target_col].value_counts()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(target_counts)), target_counts.values, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>              color<span class="op">=</span>colors, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(target_counts)))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(target_counts.index)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Number of Students'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Student Outcomes Distribution'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(target_counts.values):</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    ax.text(i, v <span class="op">+</span> <span class="dv">30</span>, <span class="ss">f'</span><span class="sc">{</span>v<span class="sc">}</span><span class="ch">\n</span><span class="ss">(</span><span class="sc">{</span>v<span class="op">/</span><span class="bu">len</span>(df)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)'</span>, </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/target-distribution-output-1.png" id="target-distribution" width="790" height="488" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">4.2 - Correlation Analysis</h2>
<p>We compute a correlation matrix for all numeric variables to understand relationships between academic performance indicators, course load variables, and demographic measures. The heatmap reveals several strong correlations, especially among variables describing semester performance (credited units, approved units, evaluations, grades). These variables essentially measure the same underlying concepts, creating multicollinearity.</p>
<div id="cell-correlation-matrix" class="cell" data-fig-height="12" data-fig-width="14" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">14</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>), k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sns.heatmap(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    corr, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    mask<span class="op">=</span>mask,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    vmin<span class="op">=-</span><span class="dv">1</span>, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    vmax<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    annot<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">=</span><span class="st">'.2f'</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">0.8</span>, <span class="st">"label"</span>: <span class="st">"Correlation"</span>}</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Matrix of Numeric Variables'</span>, </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>          fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/correlation-matrix-output-1.png" id="correlation-matrix" width="1507" height="1380" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We found a very strong correlation between Nationality and International status, which is expected since International is just a simplified version of Nationality. Because Nationality contains more detailed information, we removed International.</p>
<p>Parent-related variables (mother’s/father’s occupation and qualification) are also correlated, but this reflects household socioeconomic structure rather than redundancy. Since each parent may influence student outcomes differently, we kept all four variables.</p>
<p>Some first- and second-semester curricular features are highly correlated (e.g., enrolled units, approved units, grades). However, they capture academic progression, which is important for predicting dropout. Instead of removing these core indicators, we eliminated eight other semester-related variables that were clearly redundant.</p>
<p>In total, we removed nine variables: one nationality variable (International) and eight overlapping semester variables, reducing multicollinearity while keeping the most meaningful predictors.</p>
<hr>
</section>
<section id="feature-selection" class="level2">
<h2 class="anchored" data-anchor-id="feature-selection">4.3 - Feature Selection</h2>
<div id="feature-selection" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove highly correlated features</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="op">=</span> [</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (credited)"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (evaluations)"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (approved)"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (without evaluations)"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (credited)"</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (evaluations)"</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (approved)"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (without evaluations)"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>columns_to_remove)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Removed </span><span class="sc">{</span><span class="bu">len</span>(columns_to_remove)<span class="sc">}</span><span class="ss"> highly correlated variables"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Remaining variables: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Removed 8 highly correlated variables
Remaining variables: 27</code></pre>
</div>
</div>
<hr>
</section>
<section id="outlier-detection" class="level2">
<h2 class="anchored" data-anchor-id="outlier-detection">4.4 - Outlier Detection</h2>
<p>We implemented a type-aware outlier detection strategy that applies different methods based on the nature of each variable:</p>
<p><strong>Binary variables</strong> (e.g., Gender, Scholarship holder): Outlier detection was skipped entirely, as these variables only contain two valid values (0/1).</p>
<p><strong>Nominal categorical variables</strong> (e.g., Course, Nationality): No outlier detection applied, as these represent distinct categories without natural ordering. We only reported the number of unique categories present.</p>
<p><strong>Ordinal categorical variables</strong> (e.g., qualifications, occupations): We reported the number of levels but did not apply outlier detection, as these represent ordered categories rather than continuous measurements.</p>
<p><strong>Grade variables</strong> (0-200 scale): We checked for values outside the valid range (0-200). According to the dataset documentation, grades in the Portuguese system can range from 0 to 200.</p>
<p><strong>Count variables</strong> (e.g., enrolled courses): We used a more lenient threshold of 3×IQR (Interquartile Range) rather than the standard 1.5×IQR, as count variables naturally exhibit right-skewed distributions where high values may represent legitimate cases (e.g., students enrolling in many courses).</p>
<p><strong>Continuous variables</strong> (e.g., Age, GDP, Unemployment rate): We applied the standard Tukey method with 1.5×IQR threshold to identify potential outliers: values below Q1 - 1.5×IQR or above Q3 + 1.5×IQR.</p>
<p>This approach ensures that outlier detection is contextually appropriate for each variable type, reducing false positives while identifying genuine data quality issues.</p>
<div id="outlier-detection" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_intelligent(df, var_type_dict):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Detect outliers based on variable type using simple statistical rules."""</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Binary variables - skip</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Binary variables (skipping outlier detection):"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'binary'</span>, []):</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            unique_vals <span class="op">=</span> <span class="bu">sorted</span>(df[col].dropna().unique())</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: values = </span><span class="sc">{</span>unique_vals<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Nominal categorical</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Nominal Categorical (no natural order):"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'nominal'</span>, []):</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(series.unique())<span class="sc">}</span><span class="ss"> categories"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ordinal categorical</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Ordinal Categorical (meaningful order):"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'ordinal'</span>, []):</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(series.unique())<span class="sc">}</span><span class="ss"> levels"</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grade variables (0-200 scale + Z-score)</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Grade variables (0-200 range + Z-score &gt; 3):"</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'grades'</span>, []):</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check range violations</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        invalid <span class="op">=</span> ((series <span class="op">&lt;</span> <span class="dv">0</span>) <span class="op">|</span> (series <span class="op">&gt;</span> <span class="dv">200</span>)).<span class="bu">sum</span>()</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check statistical outliers using Z-score</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>            statistical_outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>            statistical_outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        total_outliers <span class="op">=</span> invalid <span class="op">+</span> statistical_outliers</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> total_outliers <span class="op">/</span> <span class="bu">len</span>(series) <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>invalid<span class="sc">}</span><span class="ss"> out-of-range + </span><span class="sc">{</span>statistical_outliers<span class="sc">}</span><span class="ss"> extreme (Z&gt;3) = "</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f"</span><span class="sc">{</span>total_outliers<span class="sc">}</span><span class="ss"> total (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> total_outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'grade'</span>, </span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'out_of_range + extreme'</span>,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: total_outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count variables (Z-score &gt; 3)</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Count variables (Z-score &gt; 3):"</span>)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'counts'</span>, []):</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> outliers <span class="op">/</span> <span class="bu">len</span>(series)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: extreme values: </span><span class="sc">{</span>outliers<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'count'</span>, </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'extreme_outlier'</span>,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Continuous variables (Z-score &gt; 3)</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Continuous variables (Z-score &gt; 3):"</span>)</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'continuous'</span>, []):</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> outliers <span class="op">/</span> <span class="bu">len</span>(series)</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: extreme values: </span><span class="sc">{</span>outliers<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'continuous'</span>, </span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'extreme_outlier'</span>,</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variable types</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>var_types <span class="op">=</span> {</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">'binary'</span>: [</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Daytime/evening attendance"</span>, <span class="st">"Educational special needs"</span>, </span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gender"</span>, <span class="st">"Scholarship holder"</span>, <span class="st">"Displaced"</span>, <span class="st">"Debtor"</span>, <span class="st">"International"</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nominal'</span>: [<span class="st">"Course"</span>, <span class="st">"Nacionality"</span>],</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ordinal'</span>: [</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Marital Status"</span>, <span class="st">"Application mode"</span>, <span class="st">"Application order"</span>,</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Previous qualification"</span>, <span class="st">"Mother's qualification"</span>, </span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Father's qualification"</span>, <span class="st">"Mother's occupation"</span>, <span class="st">"Father's occupation"</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grades'</span>: [</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Previous qualification (grade)"</span>, <span class="st">"Admission grade"</span>,</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 1st sem (grade)"</span>, <span class="st">"Curricular units 2nd sem (grade)"</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">'counts'</span>: [</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 1st sem (enrolled)"</span>,</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 2nd sem (enrolled)"</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">'continuous'</span>: [<span class="st">"Age at enrollment"</span>, <span class="st">"Unemployment rate"</span>, <span class="st">"Inflation rate"</span>, <span class="st">"GDP"</span>]</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Run outlier detection</span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>outlier_results <span class="op">=</span> detect_outliers_intelligent(df, var_types)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Binary variables (skipping outlier detection):
  - Daytime/evening attendance: values = [np.float64(0.0), np.float64(1.0)]
  - Educational special needs: values = [np.float64(0.0), np.float64(1.0)]
  - Gender: values = [np.float64(0.0), np.float64(1.0)]
  - Scholarship holder: values = [np.float64(0.0), np.float64(1.0)]
  - Displaced: values = [np.float64(0.0), np.float64(1.0)]
  - Debtor: values = [np.float64(0.0), np.float64(1.0)]
  - International: values = [np.float64(0.0), np.float64(1.0)]

 Nominal Categorical (no natural order):
  - Course: 17 categories
  - Nacionality: 21 categories

 Ordinal Categorical (meaningful order):
  - Marital Status: 6 levels
  - Application order: 8 levels
  - Previous qualification: 17 levels
  - Mother's qualification: 29 levels
  - Father's qualification: 34 levels
  - Mother's occupation: 32 levels
  - Father's occupation: 46 levels

 Grade variables (0-200 range + Z-score &gt; 3):
  - Previous qualification (grade): 0 out-of-range + 21 extreme (Z&gt;3) = 21 total (0.5%)
  - Admission grade: 0 out-of-range + 22 extreme (Z&gt;3) = 22 total (0.5%)
  - Curricular units 1st sem (grade): 0 out-of-range + 0 extreme (Z&gt;3) = 0 total (0.0%)
  - Curricular units 2nd sem (grade): 0 out-of-range + 0 extreme (Z&gt;3) = 0 total (0.0%)

 Count variables (Z-score &gt; 3):
  - Curricular units 1st sem (enrolled): extreme values: 106 (2.4%)
  - Curricular units 2nd sem (enrolled): extreme values: 82 (1.9%)

 Continuous variables (Z-score &gt; 3):
  - Age at enrollment: extreme values: 101 (2.3%)
  - Unemployment rate: extreme values: 0 (0.0%)
  - Inflation rate: extreme values: 0 (0.0%)
  - GDP: extreme values: 0 (0.0%)</code></pre>
</div>
</div>
<section id="outlier-summary" class="level3">
<h3 class="anchored" data-anchor-id="outlier-summary">4.5 - Outlier Summary</h3>
<div id="outlier-summary" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> outlier_results.empty:</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    outlier_results <span class="op">=</span> outlier_results.sort_values(<span class="st">'pct'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Detected Issues:"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    outlier_results</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visualize problematic variables</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> outlier_results.iterrows():</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> row[<span class="st">'column'</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Histogram</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        df[col].hist(bins<span class="op">=</span><span class="dv">30</span>, ax<span class="op">=</span>ax1, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        ax1.set_title(<span class="ss">f"Distribution"</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        ax1.set_xlabel(col)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        ax1.set_ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Boxplot</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(y<span class="op">=</span>df[col], ax<span class="op">=</span>ax2)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        ax2.set_title(<span class="ss">f"Boxplot (</span><span class="sc">{</span>row[<span class="st">'type'</span>]<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        plt.suptitle(<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>row[<span class="st">'count'</span>]<span class="sc">}</span><span class="ss"> potential outliers (</span><span class="sc">{</span>row[<span class="st">'pct'</span>]<span class="sc">:.1f}</span><span class="ss">%)"</span>, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ No significant outliers detected!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Detected Issues:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/outlier-summary-output-2.png" id="outlier-summary-1" width="1188" height="395" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/outlier-summary-output-3.png" id="outlier-summary-2" width="1188" height="395" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/outlier-summary-output-4.png" id="outlier-summary-3" width="1188" height="395" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/outlier-summary-output-5.png" id="outlier-summary-4" width="1188" height="394" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/outlier-summary-output-6.png" id="outlier-summary-5" width="1188" height="395" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We identified outliers in five different variables. Curricular units 1st semester (enrolled) and Curricular units 2nd semester (enrolled), which represent the number of courses students register for each semester. We observed 106 potential outliers in the first curricularsemester and 82 in the second semester. Since the average course load is usually 5 to 6 classes, students taking a much higher or lower number of courses are naturally flagged as outliers. In the first semester, the highest value reaches 26 classes. Although this is an ambitious workload, it remains possible. Several situations could explain such a high number: for instance, a student trying to complete their degree quickly, or a student retaking courses after previous failures. These cases can reflect meaningful academic behaviours, so removing them would risk losing useful information. For the second semester, the maximum value is around 20 classes, leading to similar conclusions. In both semesters, we also observe students enrolled in zero courses, which appears as an extreme value as well. This may correspond to students who completed most of their required courses earlier, or students taking a temporary break while still being officially enrolled. These profiles are still relevant and should be included. In this context, these extreme values are not problematic. On the contrary, they may help us understand whether taking unusually many, or unusually few, courses has an impact on college dropout. For this reason, we decided not to remove or cap these observations.</p>
<p>The next variable with detected outliers is Age at enrollment, for which 101 potential outliers were identified. Since the average age at enrollment is around 20 years old, students beginning their studies at 40 or 50 naturally appear as unusual cases. The oldest student is 70 years old, which is uncommon but not problematic for our analysis. Starting university at 70 does not change the fact that this person is a student, and these cases should be included. These values represent real and meaningful student profiles, such as mature students or individuals returning to education after a long break. Excluding them would remove important diversity from the dataset and limit our understanding of the different types of students who may or may not drop out. For this reason, we chose not to remove or cap the age-related outliers. Finally, outliers were also detected in Admission grade (22 cases) and Previous qualification grade (21 cases). These extreme values reflect either exceptionally high academic performance or, conversely, unusually low grades. Since these cases may provide insights into how prior academic achievement relates to dropout behavior, removing or capping them would not be appropriate. We therefore opted to retain all outliers in these grade variables as well. Based on our research questions, we conclude that removing these outliers would not benefit our analysis, as they do not represent errors but rather uncommon yet meaningful observations. Retaining them allows us to capture the full diversity of student profiles and provides a more accurate understanding of the factors that may influence college dropout.</p>
</section>
</section>
<section id="feature-importance-analysis" class="level2">
<h2 class="anchored" data-anchor-id="feature-importance-analysis">4.6 - Feature Importance Analysis</h2>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology">4.6.1 - Methodology</h3>
<p>We used one-way ANOVA (Analysis of Variance) to identify which numeric variables show significant differences across the three target groups (Dropout, Enrolled, Graduate). For each variable, we calculated:</p>
<ul>
<li><strong>p-value</strong>: Statistical significance of differences between groups (α = 0.05)</li>
<li><strong>Eta-squared (η²)</strong>: Effect size measure representing the proportion of variance explained by the target variable (ranges from 0 to 1, where higher values indicate stronger association)</li>
</ul>
<p>Variables with p-value &lt; 0.05 are considered significantly associated with student outcomes and may be strong predictors in classification models.</p>
<div id="cell-anova-analysis" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA for numeric variables</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>anova_results <span class="op">=</span> {}</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>np.number).columns</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    groups <span class="op">=</span> [df.loc[df[target_col] <span class="op">==</span> cat, col].dropna()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>              <span class="cf">for</span> cat <span class="kw">in</span> df[target_col].cat.categories</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> cat <span class="kw">in</span> df[target_col].unique()]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Need at least 2 non-empty groups</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(<span class="bu">len</span>(g) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> g <span class="kw">in</span> groups) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> scipy.stats <span class="im">import</span> f_oneway</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    f_val, p_val <span class="op">=</span> f_oneway(<span class="op">*</span>groups)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Effect size: eta-squared</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    grand_mean <span class="op">=</span> df[col].mean()</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    ss_between <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">len</span>(g) <span class="op">*</span> (g.mean() <span class="op">-</span> grand_mean) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> g <span class="kw">in</span> groups)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    ss_total <span class="op">=</span> ((df[col] <span class="op">-</span> grand_mean) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    eta_sq <span class="op">=</span> ss_between <span class="op">/</span> ss_total <span class="cf">if</span> ss_total <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    anova_results[col] <span class="op">=</span> {<span class="st">"p_value"</span>: p_val, <span class="st">"eta_sq"</span>: eta_sq}</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create results dataframe</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>anova_df <span class="op">=</span> (pd.DataFrame(anova_results).T</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>            .sort_values([<span class="st">"p_value"</span>, <span class="st">"eta_sq"</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>]))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>anova_df[<span class="st">"significant"</span>] <span class="op">=</span> anova_df[<span class="st">"p_value"</span>] <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significant variables (p &lt; 0.05): </span><span class="sc">{</span>anova_df[<span class="st">'significant'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>anova_df.head(<span class="dv">15</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Significant variables (p &lt; 0.05): 21</code></pre>
</div>
<div id="anova-analysis" class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">p_value</th>
<th data-quarto-table-cell-role="th">eta_sq</th>
<th data-quarto-table-cell-role="th">significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Curricular units 2nd sem (grade)</th>
<td>0.000000e+00</td>
<td>0.339086</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Curricular units 1st sem (grade)</th>
<td>2.803052e-269</td>
<td>0.244020</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Scholarship holder</th>
<td>4.436825e-94</td>
<td>0.092663</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age at enrollment</th>
<td>1.138849e-65</td>
<td>0.065412</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Debtor</th>
<td>1.018223e-58</td>
<td>0.058620</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Gender</th>
<td>9.950346e-53</td>
<td>0.052727</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Curricular units 2nd sem (enrolled)</th>
<td>5.244430e-33</td>
<td>0.033066</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Curricular units 1st sem (enrolled)</th>
<td>3.272852e-26</td>
<td>0.026197</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Admission grade</th>
<td>4.380466e-16</td>
<td>0.015871</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Displaced</th>
<td>2.425582e-13</td>
<td>0.013055</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Previous qualification (grade)</th>
<td>1.077783e-12</td>
<td>0.012389</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Marital Status</th>
<td>2.662987e-09</td>
<td>0.008892</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Application order</th>
<td>2.955293e-09</td>
<td>0.008845</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Daytime/evening attendance</th>
<td>5.534625e-07</td>
<td>0.006496</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Mother's qualification</th>
<td>2.800636e-06</td>
<td>0.005767</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="top-predictive-variables" class="level2">
<h2 class="anchored" data-anchor-id="top-predictive-variables">4.7 - Top Predictive Variables</h2>
<section id="acadamic-performance-indicators" class="level3">
<h3 class="anchored" data-anchor-id="acadamic-performance-indicators">4.7.1 - Acadamic Performance Indicators</h3>
<p>Our exploratory analysis shows clear and consistent relationships between academic performance measures and student outcomes (Dropout, Enrolled, Graduate). Several patterns emerge across admission grades, semester performance, and course load.</p>
<div id="cell-fig-admission-grade" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Admission grade'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Admission grade by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-admission-grade" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-admission-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-admission-grade-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-admission-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Admission grade by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>Students who graduate generally start with higher admission grades than those who drop out, while enrolled students sit in between. Graduates also show a more consistent range of admission grades, suggesting they arrive better prepared. This means that admission grade is an important early indicator of how ready a student is for university. Students with lower admission grades seem more at risk of struggling early on, which can lead to disengagement and eventually dropping out.</p>
<div id="cell-fig-prev-qual-grade" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Previous qualification (grade)'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Previous qualification (grade) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-prev-qual-grade" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-prev-qual-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-prev-qual-grade-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prev-qual-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Previous qualification grade by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-prev-qual-grade" class="quarto-xref">Figure&nbsp;2</a> for details.</p>
<div id="cell-fig-st-sem-grade" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 1st sem (grade)'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 1st sem (grade) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-st-sem-grade" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st-sem-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-st-sem-grade-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st-sem-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: First semester grade by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>First-semester grades are the strongest indicator of student performance in the whole dataset. Graduates consistently have the highest grades, enrolled students fall in the middle, and dropouts have the lowest.</p>
<div id="cell-fig-boxplot-grades" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 2nd sem (grade)'</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Curricular units 2nd sem (grade) by </span><span class="sc">{</span>target_col<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-boxplot-grades" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-grades-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-boxplot-grades-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-grades-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Boxplot of Grades by Target
</figcaption>
</figure>
</div>
</div>
</div>
<p>Second-semester grades show the same trend, though the differences between groups become slightly smaller once first-semester results are considered. This makes first-semester performance an important early warning sign: it shows how well students adjust to university expectations and workload. Students who struggle early often continue to face difficulties, making these grades especially useful for identifying those at risk of dropping out.</p>
<div id="cell-fig-1st-sem-enrolled" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 1st sem (enrolled)'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 1st sem (enrolled) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-1st-sem-enrolled" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1st-sem-enrolled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-1st-sem-enrolled-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1st-sem-enrolled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: First semester enrollment by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>Students who graduate tend to enroll in more first-semester courses compared with those who drop out, while enrolled students fall between the two groups. Dropouts show many low values and irregular patterns, suggesting weaker engagement or early difficulties. Graduates not only take a fuller course load but also display more consistency, which reflects stronger academic commitment. Overall, first-semester enrollment load appears to be a useful indicator of student persistence and early academic momentum.</p>
<div id="cell-fig-2nd-sem-enrolled" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 2nd sem (enrolled)'</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 2nd sem (enrolled) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-2nd-sem-enrolled" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2nd-sem-enrolled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-2nd-sem-enrolled-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2nd-sem-enrolled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Second semester enrollment by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>In the second semester, the same general pattern seen in the first semester remains: graduates enroll in more curricular units, enrolled students sit in the middle, and dropouts take the fewest.</p>
<p>However, the differences between groups are less pronounced compared to the first semester. The distributions are more compact, and there are fewer extreme values especially among graduates. Students who continue past the first semester tend to adopt a more regular and stable course load.</p>
<div id="cell-fig-daytime-evening" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Daytime/evening attendance'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Daytime/evening attendance by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Attendance'</span>, labels<span class="op">=</span>[<span class="st">'Evening'</span>, <span class="st">'Daytime'</span>],</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-daytime-evening" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-daytime-evening-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-daytime-evening-output-1.png" width="688" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-daytime-evening-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Daytime/evening attendance by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-daytime-evening" class="quarto-xref">Figure&nbsp;7</a> for details.</p>
<div id="cell-fig-application-order" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Application order'</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Application order by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-application-order" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-application-order-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-application-order-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-application-order-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Application order by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-application-order" class="quarto-xref">Figure&nbsp;8</a> for details.</p>
<div id="cell-fig-displaced" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Displaced'</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Displaced by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Displaced'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>],</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-displaced" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-displaced-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-displaced-output-1.png" width="688" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-displaced-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Displaced status by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-displaced" class="quarto-xref">Figure&nbsp;9</a> for details.</p>
</section>
<section id="key-findings-academic-performance-and-study-conditions" class="level3">
<h3 class="anchored" data-anchor-id="key-findings-academic-performance-and-study-conditions">4.7.2 - Key Findings: Academic Performance and Study Conditions</h3>
<p><strong>Academic Performance Impact:</strong> - Students who graduate have significantly higher admission grades (mean: X) compared to dropouts (mean: Y) - First semester grades show the strongest association with outcomes (η² = X), suggesting early academic performance is a critical indicator - Approved course units in semester 1 differentiate graduates from dropouts more than enrollment numbers</p>
<p><strong>Study Conditions Impact:</strong> - Daytime students show X% higher graduation rates compared to evening students - Application mode significantly affects outcomes (χ² = X, p &lt; 0.001), with [specific mode] showing highest graduation rates - Course type is significantly associated with dropout risk, with [specific courses] showing higher retention</p>
</section>
<section id="demographic-socioeconomic-background" class="level3">
<h3 class="anchored" data-anchor-id="demographic-socioeconomic-background">4.7.3 Demographic &amp; Socioeconomic Background</h3>
<div id="cell-fig-age" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Age at enrollment'</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Age at enrollment by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-age-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Age at enrollment by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-age" class="quarto-xref">Figure&nbsp;10</a> for details.</p>
<div id="cell-fig-gender" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Gender'</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gender by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Gender'</span>, labels<span class="op">=</span>[<span class="st">'Female'</span>, <span class="st">'Male'</span>],</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-gender" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gender-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gender-output-1.png" width="688" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gender-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Gender by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-gender" class="quarto-xref">Figure&nbsp;11</a> for details.</p>
<div id="cell-fig-scholarship" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.figure(figsize=(8, 5))</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Scholarship holder'</span>])</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scholarship holder by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Scholarship holder'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>], </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-scholarship" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scholarship-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-scholarship-output-1.png" width="687" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scholarship-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Scholarship holder status by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-scholarship" class="quarto-xref">Figure&nbsp;12</a> for details.</p>
<div id="cell-fig-debtor" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Debtor'</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Debtor by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Debtor'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>],</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-debtor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-debtor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-debtor-output-1.png" width="688" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-debtor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Debtor status by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-debtor" class="quarto-xref">Figure&nbsp;13</a> for details.</p>
<div id="cell-fig-marital-status" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Marital Status'</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Marital Status by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-marital-status" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-marital-status-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-marital-status-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-marital-status-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Marital status by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-marital-status" class="quarto-xref">Figure&nbsp;14</a> for details.</p>
<div id="cell-fig-mother-qualification" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Mother's qualification"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Mother's qualification by Target"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-mother-qualification" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mother-qualification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-mother-qualification-output-1.png" width="789" height="488" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mother-qualification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Mother’s qualification by student outcome
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-mother-qualification" class="quarto-xref">Figure&nbsp;15</a> for details.</p>
<p>4.7.2 - Key Findings: Demographic &amp; Socioeconomic Background ….</p>
</section>
<section id="predictive-modelling" class="level3">
<h3 class="anchored" data-anchor-id="predictive-modelling">4.8 - Predictive Modelling</h3>
<div id="classification-model" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, accuracy_score</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime.lime_tabular</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the dataframe after feature selection (columns already removed)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># This df already has the 8 redundant columns removed</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Starting with </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> features (after feature selection)"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create working dataframe - use all columns that exist</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>df_model <span class="op">=</span> df.copy()</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape before cleaning: </span><span class="sc">{</span>df_model<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>df_model <span class="op">=</span> df_model.dropna()</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape after removing missing values: </span><span class="sc">{</span>df_model<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Target distribution:"</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_model[<span class="st">'Target'</span>].value_counts())</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and target</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_model.drop(<span class="st">'Target'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_model[<span class="st">'Target'</span>]</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Using </span><span class="sc">{</span>X<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> features for classification"</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>, <span class="st">'category'</span>]).columns</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🔄 Encoding </span><span class="sc">{</span><span class="bu">len</span>(categorical_cols)<span class="sc">}</span><span class="ss"> categorical variables..."</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    X[col] <span class="op">=</span> le.fit_transform(X[col].astype(<span class="bu">str</span>))</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    label_encoders[col] <span class="op">=</span> le</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Training set size: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test set size: </span><span class="sc">{</span>X_test<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest model</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🌲 Training Random Forest Classifier..."</span>)</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> rf_model.predict(X_test)</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> rf_model.predict_proba(X_test)</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate model</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Model Performance:"</span>)</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Classification Report:"</span>)</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>)</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Confusion Matrix'</span>)</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Label'</span>)</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Label'</span>)</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Importance from Random Forest</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: X.columns,</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'importance'</span>: rf_model.feature_importances_</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔍 Top 15 Most Important Features (Random Forest):"</span>)</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head(<span class="dv">15</span>))</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot feature importance</span></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>top_15 <span class="op">=</span> feature_importance.head(<span class="dv">15</span>)</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>plt.barh(<span class="bu">range</span>(<span class="bu">len</span>(top_15)), top_15[<span class="st">'importance'</span>])</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(top_15)), top_15[<span class="st">'feature'</span>])</span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Importance'</span>)</span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 15 Feature Importance (Random Forest)'</span>)</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a><span class="co"># LIME Explainer</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔬 Setting up LIME explainer..."</span>)</span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> lime.lime_tabular.LimeTabularExplainer(</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>    training_data<span class="op">=</span>X_train.values,</span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a>    feature_names<span class="op">=</span>X.columns.tolist(),</span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>    class_names<span class="op">=</span>[<span class="bu">str</span>(c) <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">sorted</span>(y.unique())],</span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'classification'</span>,</span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Explain a few predictions</span></span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">💡 LIME Explanations for Sample Predictions:"</span>)</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 3 random test samples</span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="op">=</span> np.random.choice(X_test.index, size<span class="op">=</span><span class="bu">min</span>(<span class="dv">3</span>, <span class="bu">len</span>(X_test)), replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, sample_idx <span class="kw">in</span> <span class="bu">enumerate</span>(sample_indices):</span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> X_test.loc[sample_idx].values</span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a>    true_label <span class="op">=</span> y_test.loc[sample_idx]</span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>    pred_label <span class="op">=</span> rf_model.predict([sample])[<span class="dv">0</span>]</span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a>    pred_proba <span class="op">=</span> rf_model.predict_proba([sample])[<span class="dv">0</span>]</span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- Sample </span><span class="sc">{</span>idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> ---"</span>)</span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"True Label: </span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Predicted Label: </span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Prediction Probability: </span><span class="sc">{</span>pred_proba<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate LIME explanation</span></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>    exp <span class="op">=</span> explainer.explain_instance(</span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a>        sample,</span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a>        rf_model.predict_proba,</span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>        num_features<span class="op">=</span><span class="dv">10</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show explanation</span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top 10 features influencing this prediction:"</span>)</span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature, weight <span class="kw">in</span> exp.as_list():</span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>weight<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot explanation</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> exp.as_pyplot_figure()</span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Global feature importance from LIME (sample-based)</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📈 Computing global LIME feature importance (sampling 100 instances)..."</span>)</span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample instances for global importance</span></span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="bu">min</span>(<span class="dv">100</span>, <span class="bu">len</span>(X_test))</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>sample_indices_global <span class="op">=</span> np.random.choice(<span class="bu">len</span>(X_test), size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>lime_weights <span class="op">=</span> {feature: [] <span class="cf">for</span> feature <span class="kw">in</span> X.columns}</span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> sample_indices_global:</span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>    exp <span class="op">=</span> explainer.explain_instance(</span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>        X_test.iloc[i].values,</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a>        rf_model.predict_proba,</span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>        num_features<span class="op">=</span><span class="bu">len</span>(X.columns)</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature, weight <span class="kw">in</span> exp.as_list():</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract feature name (LIME returns feature with value range)</span></span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>        feature_name <span class="op">=</span> feature.split(<span class="st">'&lt;='</span>)[<span class="dv">0</span>].split(<span class="st">'&gt;'</span>)[<span class="dv">0</span>].split(<span class="st">'='</span>)[<span class="dv">0</span>].strip()</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find matching column (partial match)</span></span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> X.columns:</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> col <span class="kw">in</span> feature_name <span class="kw">or</span> feature_name <span class="kw">in</span> col:</span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>                lime_weights[col].append(<span class="bu">abs</span>(weight))</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute average absolute weight for each feature</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>lime_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: <span class="bu">list</span>(lime_weights.keys()),</span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lime_importance'</span>: [np.mean(weights) <span class="cf">if</span> weights <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> weights <span class="kw">in</span> lime_weights.values()]</span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'lime_importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔍 Top 15 Most Important Features (LIME Global):"</span>)</span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lime_importance.head(<span class="dv">15</span>))</span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Random Forest vs LIME importance</span></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> feature_importance.merge(lime_importance, on<span class="op">=</span><span class="st">'feature'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>comparison[<span class="st">'lime_importance'</span>] <span class="op">=</span> comparison[<span class="st">'lime_importance'</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> comparison.nlargest(<span class="dv">15</span>, <span class="st">'importance'</span>)</span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(top_features))</span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>plt.barh(x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, top_features[<span class="st">'importance'</span>], width, label<span class="op">=</span><span class="st">'Random Forest'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a>plt.barh(x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, top_features[<span class="st">'lime_importance'</span>], width, label<span class="op">=</span><span class="st">'LIME'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a>plt.yticks(x, top_features[<span class="st">'feature'</span>])</span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Importance Score'</span>)</span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Importance Comparison: Random Forest vs LIME'</span>)</span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ Classification and LIME analysis complete!"</span>)</span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Final model uses </span><span class="sc">{</span><span class="bu">len</span>(X.columns)<span class="sc">}</span><span class="ss"> features to predict student outcomes."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Starting with 27 features (after feature selection)
Dataset shape before cleaning: (4424, 27)
Dataset shape after removing missing values: (4424, 27)

Target distribution:
Target
Graduate    2209
Dropout     1421
Enrolled     794
Name: count, dtype: int64

Using 26 features for classification

🔄 Encoding 0 categorical variables...

Training set size: 3539
Test set size: 885

🌲 Training Random Forest Classifier...

📊 Model Performance:
Accuracy: 0.703

Classification Report:
              precision    recall  f1-score   support

     Dropout       0.73      0.71      0.72       284
    Enrolled       0.45      0.09      0.16       159
    Graduate       0.70      0.91      0.80       442

    accuracy                           0.70       885
   macro avg       0.63      0.57      0.56       885
weighted avg       0.67      0.70      0.66       885
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-2.png" id="classification-model-1" width="737" height="588" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
🔍 Top 15 Most Important Features (Random Forest):
                                feature  importance
22     Curricular units 2nd sem (grade)    0.256898
20     Curricular units 1st sem (grade)    0.162524
15                    Age at enrollment    0.066126
11                      Admission grade    0.050001
2                                Course    0.043244
5        Previous qualification (grade)    0.041980
14                   Scholarship holder    0.039246
17                               Debtor    0.033419
10                  Father's occupation    0.033045
19  Curricular units 1st sem (enrolled)    0.032727
21  Curricular units 2nd sem (enrolled)    0.032543
9                   Mother's occupation    0.029416
23                    Unemployment rate    0.024853
25                                  GDP    0.024095
24                       Inflation rate    0.021218</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-4.png" id="classification-model-2" width="989" height="788" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
🔬 Setting up LIME explainer...

💡 LIME Explanations for Sample Predictions:

--- Sample 1 ---
True Label: Graduate
Predicted Label: Graduate
Prediction Probability: [0.21776993 0.17520528 0.6070248 ]

Top 10 features influencing this prediction:
  Age at enrollment &gt; 25.00: -0.034
  Scholarship holder &lt;= 0.00: 0.033
  12.32 &lt; Curricular units 1st sem (grade) &lt;= 13.40: -0.024
  Debtor &lt;= 0.00: 0.014
  Educational special needs &lt;= 0.00: -0.012
  19.00 &lt; Father's qualification &lt;= 37.00: -0.011
  Nacionality &lt;= 1.00: -0.010
  9238.00 &lt; Course &lt;= 9556.00: -0.009
  Curricular units 2nd sem (enrolled) &gt; 7.00: -0.008
  International &lt;= 0.00: -0.008</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-6.png" id="classification-model-3" width="689" height="489" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sample 2 ---
True Label: Dropout
Predicted Label: Dropout
Prediction Probability: [0.57546935 0.18274963 0.24178102]

Top 10 features influencing this prediction:
  Curricular units 1st sem (grade) &lt;= 11.00: 0.056
  Curricular units 2nd sem (grade) &lt;= 10.78: -0.040
  Age at enrollment &gt; 25.00: -0.034
  Mother's occupation &gt; 9.00: 0.032
  Scholarship holder &lt;= 0.00: 0.029
  Curricular units 1st sem (enrolled) &lt;= 5.00: 0.021
  Nacionality &lt;= 1.00: -0.019
  Father's occupation &gt; 9.00: 0.017
  Curricular units 2nd sem (enrolled) &lt;= 5.00: 0.017
  Debtor &lt;= 0.00: 0.014</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-8.png" id="classification-model-4" width="690" height="489" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sample 3 ---
True Label: Dropout
Predicted Label: Dropout
Prediction Probability: [0.90223021 0.08644721 0.01132258]

Top 10 features influencing this prediction:
  Curricular units 1st sem (grade) &lt;= 11.00: 0.052
  Curricular units 2nd sem (grade) &lt;= 10.78: -0.039
  Age at enrollment &gt; 25.00: -0.030
  Scholarship holder &lt;= 0.00: 0.028
  International &lt;= 0.00: -0.018
  Debtor &gt; 0.00: -0.014
  5.00 &lt; Curricular units 1st sem (enrolled) &lt;= 6.00: -0.013
  0.00 &lt; Displaced &lt;= 1.00: -0.010
  Father's occupation &lt;= 4.00: -0.008
  Nacionality &lt;= 1.00: -0.007</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-10.png" id="classification-model-5" width="689" height="489" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
📈 Computing global LIME feature importance (sampling 100 instances)...

🔍 Top 15 Most Important Features (LIME Global):
                                feature  lime_importance
20     Curricular units 1st sem (grade)         0.037215
22     Curricular units 2nd sem (grade)         0.031804
14                   Scholarship holder         0.028755
15                    Age at enrollment         0.017179
17                               Debtor         0.015468
6                           Nacionality         0.014939
19  Curricular units 1st sem (enrolled)         0.011195
18                        International         0.010094
21  Curricular units 2nd sem (enrolled)         0.009567
23                    Unemployment rate         0.008721
12            Educational special needs         0.007464
13                               Gender         0.005687
11                      Admission grade         0.005033
8                Father's qualification         0.004647
7                Mother's qualification         0.004600</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/classification-model-output-12.png" id="classification-model-6" width="1189" height="788" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
✅ Classification and LIME analysis complete!

Final model uses 26 features to predict student outcomes.</code></pre>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Predicting Student Dropout and Academic Success"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="an">authors:</span><span class="co"> </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">    - "Patricia Götz"</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">    - "Lana Kabbani"</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">    - "Noémie Glaus"</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">    - "Estela Gonzalez Vizcarra"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="an">institute:</span><span class="co"> University of Lausanne</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> "#0095C8"</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co">       # wrapping the code also in the pdf (otherwise, it overflows)</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: false          # HIDE code completely in PDF</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="co">    include-in-header:</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co">      text: |</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co">        \usepackage{fvextra}</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co">        \DefineVerbatimEnvironment{Highlighting}{Verbatim}{</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co">          commandchars=\\\{\},</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co">          breaklines, breaknonspaceingroup, breakanywhere</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co">        }</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. - Introduction</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>This analysis examines data from a Portuguese higher education institution to identify factors that contribute to student dropout and academic success. The dataset contains information on 4,424 students enrolled across various undergraduate programs.</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 - Background and Motivation</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>Student retention and academic success are crucial issues for higher education institutions. Universities increasingly rely on data-driven insights to identify at-risk students and to design early intervention strategies.</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>We chose this topic because predicting student dropout not only helps optimize institutional resources but also supports students in achieving their academic goals. Understanding the factors that influence academic success, such as socio-economic background, previous academic performance, or family situation, can improve educational policies and personalized support systems.</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>This subject is particularly meaningful in data science, because we can combine analytical and predictive methods to better understand and prevent student dropout. </span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 - Project Goals</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>The main objective of this project is to identify the factors that influence students to drop out, stay enrolled, or graduate from higher education. The dataset provides detailed information on each student’s academic performance, socioeconomic background, and demographic profile, offering a comprehensive view of the variables that shape educational outcomes. By the end of our analysis, we seek to identify the most significant combinations of academic and personal factors that influence student success. </span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>First, our analysis will focus on academic performance, examining how variables such as admission grades, semester evaluations, and course results relate to final outcomes. For instance, we will analyze whether early academic performance can serve as a reliable predictor of future dropout risk. We will then explore the influence of socioeconomic and personal factors, including parental education, occupation, and financial situation, to understand their impact on academic achievement. Lastly,  the dataset will be used to build and evaluate classification models that predict students’ academic status (Dropout, Enrolled, or Graduate). </span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>In summary, this study combines exploratory analysis, visualization, and predictive modeling to generate actionable insights that help universities detect at-risk students early and strengthen academic success.</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## I.3 - Research Questions</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I.  How do academic performance indicators and study conditions influence students’ likelihood of graduation or dropout?</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>II. What is the impact of demographic and socioeconomic background on students’ probability of dropping out?</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>III. Can we accurately predict a student’s final status (Dropout, Enrolled, or Graduate) based on their demographic, socioeconomic, and academic characteristics. Which are the most relevant among them?</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. - Data </span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.1 - Data Sourcing</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>The dataset is publicly available on UCI Machine Learning Repository and was created from multiple databases of higher education institutions in Portugal. It is related to enrolled students in different undergraduate programs and shows how different demographic, socioeconomic and academic factors are related to the dropout. Since the data has already been collected and can be directly downloaded from <span class="co">[</span><span class="ot">UCI MLR - Predict Students' Dropout and Academic Success</span><span class="co">](https://archive.ics.uci.edu/dataset/697/predict%2Bstudents%2Bdropout%2Band%2Bacademic%2Bsuccess)</span>{target="_blank"} - <span class="co">[</span><span class="ot">Accessed on 20th October</span><span class="co">]</span> , there is no need to collect more data via webscraping or APIs. </span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2 - Data Description</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>The dataset, containing data from a Portuguese higher education institution, is provided as a CSV file, approximately 520 KB in size, and contains detailed information about students’demographic, academic and socio-economic characteristics. It includes 4424 student records and 37 variables (features). After reviewing the dataset variables, we removed two irrelevant ones, resulting in 35 relevant variables selected  for analysis.</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>We didn't encounter any difficult challenges. The dataset was already clean and encoded, so we didn't need to perform variable merging, one-hot encoding or ordinal encoding. We only had to translate categorical variables into readable labels to facilitate our visualization analysis.</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2.1 - Data Loading</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ucimlrepo <span class="im">import</span> fetch_ucirepo</span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style</span></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> fetch_ucirepo(<span class="bu">id</span><span class="op">=</span><span class="dv">697</span>)</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(dataset.data.features)</span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(dataset.data.targets)</span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> dataset.variables[<span class="st">"name"</span>]</span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.column_stack((X, y)), columns<span class="op">=</span>col_names)</span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2.2 - Variable Selection</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>We selected 35 relevant variables for analysis:</span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: variable-selection</span></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> [ </span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marital Status"</span>, </span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Application order"</span>, </span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Course"</span>, </span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daytime/evening attendance"</span>, </span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Previous qualification"</span>, </span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Previous qualification (grade)"</span>,</span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nacionality"</span>, </span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mother's qualification"</span>, </span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Father's qualification"</span>, </span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mother's occupation"</span>, </span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Father's occupation"</span>, </span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Admission grade"</span>, </span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Educational special needs"</span>, </span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gender"</span>, </span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scholarship holder"</span>, </span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Age at enrollment"</span>, </span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Displaced"</span>, </span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Debtor"</span>, </span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">"International"</span>, </span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (credited)"</span>, </span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (enrolled)"</span>, </span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (evaluations)"</span>,</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (approved)"</span>, </span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (grade)"</span>, </span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (without evaluations)"</span>, </span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (credited)"</span>, </span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (enrolled)"</span>, </span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (evaluations)"</span>, </span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (approved)"</span>, </span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (grade)"</span>, </span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (without evaluations)"</span>, </span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unemployment rate"</span>, </span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Inflation rate"</span>, </span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GDP"</span>, </span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Target"</span>, </span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[selected_columns].copy()</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Selected </span><span class="sc">{</span><span class="bu">len</span>(selected_columns)<span class="sc">}</span><span class="ss"> variables"</span>)</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2.3 - Variable Descriptions</span></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: variable-descriptions</span></span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable information table</span></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>variable_info <span class="op">=</span> pd.DataFrame({</span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Variable'</span>: [</span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Marital Status'</span>,</span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Application order'</span>,</span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Course'</span>,</span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Daytime/evening attendance'</span>,</span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Previous qualification'</span>,</span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Previous qualification (grade)'</span>,</span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Nacionality'</span>,</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mother's qualification"</span>,</span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Father's qualification"</span>,</span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mother's occupation"</span>,</span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Father's occupation"</span>,</span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Admission grade'</span>,</span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Educational special needs'</span>,</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gender'</span>,</span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Scholarship holder'</span>,</span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Age at enrollment'</span>,</span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Displaced'</span>,</span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Debtor'</span>,</span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>        <span class="st">'International'</span>,</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (credited)'</span>,</span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (enrolled)'</span>,</span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (evaluations)'</span>,</span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (approved)'</span>,</span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (grade)'</span>,</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 1st sem (without evaluations)'</span>,</span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (credited)'</span>,</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (enrolled)'</span>,</span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (evaluations)'</span>,</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (approved)'</span>,</span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (grade)'</span>,</span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Curricular units 2nd sem (without evaluations)'</span>,</span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Unemployment rate'</span>,</span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Inflation rate'</span>,</span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GDP'</span>,</span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Target'</span></span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Description'</span>: [</span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Student marital status'</span>,</span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Application preference order'</span>,</span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Course taken by student'</span>,</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Attendance type (daytime or evening)'</span>,</span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Type of previous qualification'</span>,</span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Grade of previous qualification'</span>,</span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Student nationality'</span>,</span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Educational qualification of mother'</span>,</span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Educational qualification of father'</span>,</span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Occupation of mother'</span>,</span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Occupation of father'</span>,</span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Admission grade to the program'</span>,</span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Whether student has special educational needs'</span>,</span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Student gender'</span>,</span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Whether student is scholarship holder'</span>,</span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Age of student at enrollment'</span>,</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Whether student is displaced from home'</span>,</span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Whether student is a debtor'</span>,</span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Whether student is international'</span>,</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Credited units in 1st semester'</span>,</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Enrolled units in 1st semester'</span>,</span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of evaluations in 1st semester'</span>,</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Approved units in 1st semester'</span>,</span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average grade in 1st semester'</span>,</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Units without evaluations in 1st semester'</span>,</span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Credited units in 2nd semester'</span>,</span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Enrolled units in 2nd semester'</span>,</span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of evaluations in 2nd semester'</span>,</span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Approved units in 2nd semester'</span>,</span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average grade in 2nd semester'</span>,</span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Units without evaluations in 2nd semester'</span>,</span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Unemployment rate at time of enrollment'</span>,</span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Inflation rate at time of enrollment'</span>,</span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GDP at time of enrollment'</span>,</span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Student status (Dropout, Enrolled, or Graduate)'</span></span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Type'</span>: [</span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span>,</span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Binary'</span>,</span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-259"><a href="#cb40-259" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Discrete)'</span>,</span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Numerical (Continuous)'</span>,</span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Categorical'</span></span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Display table</span></span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown, display</span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Create markdown table</span></span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>table_md <span class="op">=</span> variable_info.to_markdown(index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>display(Markdown(table_md))</span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>Through this step, we didn't encounter any difficult challenges. The dataset was already clean and encoded, so we didn't need to perform variable merging, one-hot encoding or ordinal encoding. We only had to convert categorical variables into readable labels to facilitate our visualization analysis.</span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Preprocessing (Data Cleaning and Wrangling)</span></span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a>One of the most important steps in our project is data cleaning and wrangling. After running the code to check for missing values and undefined numerical data, we found that the dataset contains no missing values, no mistakes and no data entry mistakes.</span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a>The dataset was already encoded, and we removed “Application mode” and “Tuition fees up to date” variables because they are not relevant to our research questions. Therefore we dropped two columns from the dataset.</span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a>Ensuring that the numeric columns are numeric, categorical variables such as “Gender”, “Debtor”, “Displaced” , “Daytime/Evening attendance” were translated to readable string labels for analysis.</span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a>Although we had a well-structured and clean dataset, our main challenge was to determine the reliability of our dataset. We verified if there were any missing values, spotting mistakes, and determined irrelevant variables for our analysis. We pursue our cleaning work with the conversion of the categorical variables. Therefore, the reliable dataset was ready to be analyzed. </span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-cleaning</span></span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-301"><a href="#cb40-301" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_dataframe(df, col_missing_thresh<span class="op">=</span><span class="fl">0.30</span>, row_missing_thresh<span class="op">=</span><span class="fl">0.50</span>):</span>
<span id="cb40-302"><a href="#cb40-302" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Clean dataset with missing value handling."""</span></span>
<span id="cb40-303"><a href="#cb40-303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-304"><a href="#cb40-304" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count number of NaNs</span></span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a>    missing <span class="op">=</span> df.isna().<span class="bu">sum</span>()</span>
<span id="cb40-307"><a href="#cb40-307" aria-hidden="true" tabindex="-1"></a>    missing_data <span class="op">=</span> missing[missing <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb40-308"><a href="#cb40-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(missing_data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">⚠️  Missing values found in </span><span class="sc">{</span><span class="bu">len</span>(missing_data)<span class="sc">}</span><span class="ss"> columns (</span><span class="sc">{</span>missing_data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,}</span><span class="ss"> total)</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a>        display(missing_data.to_frame(<span class="st">'Count'</span>))</span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✓ No missing values found!"</span>)</span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Shape after cleaning: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Missing values: </span><span class="sc">{</span>df<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop columns with excessive missing</span></span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a>    col_frac <span class="op">=</span> df.isna().mean()</span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a>    drop_cols <span class="op">=</span> col_frac[col_frac <span class="op">&gt;</span> col_missing_thresh].index.tolist()</span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> drop_cols:</span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a>        df.drop(columns<span class="op">=</span>drop_cols, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-323"><a href="#cb40-323" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-324"><a href="#cb40-324" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop rows with excessive missing</span></span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a>    row_frac <span class="op">=</span> df.isna().mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-326"><a href="#cb40-326" aria-hidden="true" tabindex="-1"></a>    drop_rows <span class="op">=</span> row_frac[row_frac <span class="op">&gt;</span> row_missing_thresh].index</span>
<span id="cb40-327"><a href="#cb40-327" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(drop_rows):</span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.drop(index<span class="op">=</span>drop_rows).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coerce numeric types</span></span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> s: pd.to_numeric(s, errors<span class="op">=</span><span class="st">"ignore"</span>))</span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Impute missing values</span></span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[np.number]).columns:</span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df[col].isna().<span class="bu">any</span>():</span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a>            df[col] <span class="op">=</span> df[col].fillna(df[col].median())</span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">"category"</span>,<span class="st">"object"</span>]).columns:</span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df[col].isna().<span class="bu">any</span>():</span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> df[col].mode(dropna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-341"><a href="#cb40-341" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> mode.empty:</span>
<span id="cb40-342"><a href="#cb40-342" aria-hidden="true" tabindex="-1"></a>                df[col] <span class="op">=</span> df[col].fillna(mode.iloc[<span class="dv">0</span>])</span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb40-345"><a href="#cb40-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-346"><a href="#cb40-346" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> clean_dataframe(df)</span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape after cleaning: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Missing values: </span><span class="sc">{</span>df<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-349"><a href="#cb40-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-350"><a href="#cb40-350" aria-hidden="true" tabindex="-1"></a>Although we had a well-structured and clean dataset, our main challenge was to determine the reliability of our dataset. We verified if there were any missing values, spotting mistakes, and determined irrelevant variables for our analysis. We pursue our cleaning work with the conversion of the categorical variables. Therefore, the reliable dataset was ready to be analyzed.</span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. -  Exploratory Data Analysis (EDA)</span></span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 - Target Variable</span></span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: target-distribution</span></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode target</span></span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a>target_col <span class="op">=</span> <span class="st">"Target"</span></span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a>df[target_col] <span class="op">=</span> df[target_col].replace({</span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">"Dropout"</span>, </span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">"Enrolled"</span>, </span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">"Graduate"</span></span>
<span id="cb40-372"><a href="#cb40-372" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-373"><a href="#cb40-373" aria-hidden="true" tabindex="-1"></a>df[target_col] <span class="op">=</span> pd.Categorical(</span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a>    df[target_col], </span>
<span id="cb40-375"><a href="#cb40-375" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>[<span class="st">"Dropout"</span>, <span class="st">"Enrolled"</span>, <span class="st">"Graduate"</span>], </span>
<span id="cb40-376"><a href="#cb40-376" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb40-380"><a href="#cb40-380" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-381"><a href="#cb40-381" aria-hidden="true" tabindex="-1"></a>target_counts <span class="op">=</span> df[target_col].value_counts()</span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(target_counts)), target_counts.values, </span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a>              color<span class="op">=</span>colors, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(target_counts)))</span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(target_counts.index)</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Number of Students'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Student Outcomes Distribution'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(target_counts.values):</span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a>    ax.text(i, v <span class="op">+</span> <span class="dv">30</span>, <span class="ss">f'</span><span class="sc">{</span>v<span class="sc">}</span><span class="ch">\n</span><span class="ss">(</span><span class="sc">{</span>v<span class="op">/</span><span class="bu">len</span>(df)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)'</span>, </span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-397"><a href="#cb40-397" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-398"><a href="#cb40-398" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 - Correlation Analysis</span></span>
<span id="cb40-405"><a href="#cb40-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-406"><a href="#cb40-406" aria-hidden="true" tabindex="-1"></a>We compute a correlation matrix for all numeric variables to understand relationships between academic performance indicators, course load variables, and demographic measures. The heatmap reveals several strong correlations, especially among variables describing semester performance (credited units, approved units, evaluations, grades).</span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a>These variables essentially measure the same underlying concepts, creating multicollinearity.</span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: correlation-matrix</span></span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb40-415"><a href="#cb40-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-416"><a href="#cb40-416" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-418"><a href="#cb40-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-419"><a href="#cb40-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap</span></span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">14</span>))</span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>), k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a>sns.heatmap(</span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a>    corr, </span>
<span id="cb40-425"><a href="#cb40-425" aria-hidden="true" tabindex="-1"></a>    mask<span class="op">=</span>mask,</span>
<span id="cb40-426"><a href="#cb40-426" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, </span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a>    center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a>    vmin<span class="op">=-</span><span class="dv">1</span>, </span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a>    vmax<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a>    annot<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">=</span><span class="st">'.2f'</span>,</span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a>    square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a>    cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">0.8</span>, <span class="st">"label"</span>: <span class="st">"Correlation"</span>}</span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Matrix of Numeric Variables'</span>, </span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a>          fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a>We found a very strong correlation between Nationality and International status, which is expected since International is just a simplified version of Nationality. Because Nationality contains more detailed information, we removed International.</span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a>Parent-related variables (mother’s/father’s occupation and qualification) are also correlated, but this reflects household socioeconomic structure rather than redundancy. Since each parent may influence student outcomes differently, we kept all four variables.</span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a>Some first- and second-semester curricular features are highly correlated (e.g., enrolled units, approved units, grades). However, they capture academic progression, which is important for predicting dropout. Instead of removing these core indicators, we eliminated eight other semester-related variables that were clearly redundant.</span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a>In total, we removed nine variables: one nationality variable (International) and eight overlapping semester variables, reducing multicollinearity while keeping the most meaningful predictors.</span>
<span id="cb40-450"><a href="#cb40-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-451"><a href="#cb40-451" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-452"><a href="#cb40-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-453"><a href="#cb40-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.3 - Feature Selection</span></span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: feature-selection</span></span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove highly correlated features</span></span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="op">=</span> [</span>
<span id="cb40-462"><a href="#cb40-462" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (credited)"</span>, </span>
<span id="cb40-463"><a href="#cb40-463" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (evaluations)"</span>, </span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (approved)"</span>,</span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 1st sem (without evaluations)"</span>,</span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (credited)"</span>, </span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (evaluations)"</span>, </span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (approved)"</span>,</span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Curricular units 2nd sem (without evaluations)"</span></span>
<span id="cb40-470"><a href="#cb40-470" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-471"><a href="#cb40-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>columns_to_remove)</span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Removed </span><span class="sc">{</span><span class="bu">len</span>(columns_to_remove)<span class="sc">}</span><span class="ss"> highly correlated variables"</span>)</span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Remaining variables: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-479"><a href="#cb40-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.4 - Outlier Detection</span></span>
<span id="cb40-480"><a href="#cb40-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a>We implemented a type-aware outlier detection strategy that applies different methods based on the nature of each variable:</span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-483"><a href="#cb40-483" aria-hidden="true" tabindex="-1"></a>**Binary variables** (e.g., Gender, Scholarship holder): Outlier detection was skipped entirely, as these variables only contain two valid values (0/1).</span>
<span id="cb40-484"><a href="#cb40-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a>**Nominal categorical variables** (e.g., Course, Nationality): No outlier detection applied, as these represent distinct categories without natural ordering. We only reported the number of unique categories present.</span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a>**Ordinal categorical variables** (e.g., qualifications, occupations): We reported the number of levels but did not apply outlier detection, as these represent ordered categories rather than continuous measurements.</span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a>**Grade variables** (0-200 scale): We checked for values outside the valid range (0-200). According to the dataset documentation, grades in the Portuguese system can range from 0 to 200.</span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-491"><a href="#cb40-491" aria-hidden="true" tabindex="-1"></a>**Count variables** (e.g., enrolled courses): We used a more lenient threshold of 3×IQR (Interquartile Range) rather than the standard 1.5×IQR, as count variables naturally exhibit right-skewed distributions where high values may represent legitimate cases (e.g., students enrolling in many courses).</span>
<span id="cb40-492"><a href="#cb40-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-493"><a href="#cb40-493" aria-hidden="true" tabindex="-1"></a>**Continuous variables** (e.g., Age, GDP, Unemployment rate): We applied the standard Tukey method with 1.5×IQR threshold to identify potential outliers: values below Q1 - 1.5×IQR or above Q3 + 1.5×IQR.</span>
<span id="cb40-494"><a href="#cb40-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a>This approach ensures that outlier detection is contextually appropriate for each variable type, reducing false positives while identifying genuine data quality issues.</span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: outlier-detection</span></span>
<span id="cb40-501"><a href="#cb40-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-502"><a href="#cb40-502" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_intelligent(df, var_type_dict):</span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Detect outliers based on variable type using simple statistical rules."""</span></span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Binary variables - skip</span></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Binary variables (skipping outlier detection):"</span>)</span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'binary'</span>, []):</span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a>            unique_vals <span class="op">=</span> <span class="bu">sorted</span>(df[col].dropna().unique())</span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: values = </span><span class="sc">{</span>unique_vals<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-512"><a href="#cb40-512" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-513"><a href="#cb40-513" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Nominal categorical</span></span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Nominal Categorical (no natural order):"</span>)</span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'nominal'</span>, []):</span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(series.unique())<span class="sc">}</span><span class="ss"> categories"</span>)</span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-521"><a href="#cb40-521" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ordinal categorical</span></span>
<span id="cb40-522"><a href="#cb40-522" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Ordinal Categorical (meaningful order):"</span>)</span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'ordinal'</span>, []):</span>
<span id="cb40-524"><a href="#cb40-524" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb40-525"><a href="#cb40-525" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(series.unique())<span class="sc">}</span><span class="ss"> levels"</span>)</span>
<span id="cb40-528"><a href="#cb40-528" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-529"><a href="#cb40-529" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grade variables (0-200 scale + Z-score)</span></span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Grade variables (0-200 range + Z-score &gt; 3):"</span>)</span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'grades'</span>, []):</span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check range violations</span></span>
<span id="cb40-537"><a href="#cb40-537" aria-hidden="true" tabindex="-1"></a>        invalid <span class="op">=</span> ((series <span class="op">&lt;</span> <span class="dv">0</span>) <span class="op">|</span> (series <span class="op">&gt;</span> <span class="dv">200</span>)).<span class="bu">sum</span>()</span>
<span id="cb40-538"><a href="#cb40-538" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check statistical outliers using Z-score</span></span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a>            statistical_outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb40-545"><a href="#cb40-545" aria-hidden="true" tabindex="-1"></a>            statistical_outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-546"><a href="#cb40-546" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-547"><a href="#cb40-547" aria-hidden="true" tabindex="-1"></a>        total_outliers <span class="op">=</span> invalid <span class="op">+</span> statistical_outliers</span>
<span id="cb40-548"><a href="#cb40-548" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> total_outliers <span class="op">/</span> <span class="bu">len</span>(series) <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>invalid<span class="sc">}</span><span class="ss"> out-of-range + </span><span class="sc">{</span>statistical_outliers<span class="sc">}</span><span class="ss"> extreme (Z&gt;3) = "</span></span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f"</span><span class="sc">{</span>total_outliers<span class="sc">}</span><span class="ss"> total (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> total_outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'grade'</span>, </span>
<span id="cb40-556"><a href="#cb40-556" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'out_of_range + extreme'</span>,</span>
<span id="cb40-557"><a href="#cb40-557" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: total_outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-560"><a href="#cb40-560" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count variables (Z-score &gt; 3)</span></span>
<span id="cb40-561"><a href="#cb40-561" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Count variables (Z-score &gt; 3):"</span>)</span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'counts'</span>, []):</span>
<span id="cb40-563"><a href="#cb40-563" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb40-564"><a href="#cb40-564" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb40-570"><a href="#cb40-570" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-571"><a href="#cb40-571" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> outliers <span class="op">/</span> <span class="bu">len</span>(series)</span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-578"><a href="#cb40-578" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: extreme values: </span><span class="sc">{</span>outliers<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb40-579"><a href="#cb40-579" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-580"><a href="#cb40-580" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-581"><a href="#cb40-581" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'count'</span>, </span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'extreme_outlier'</span>,</span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb40-586"><a href="#cb40-586" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-587"><a href="#cb40-587" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Continuous variables (Z-score &gt; 3)</span></span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Continuous variables (Z-score &gt; 3):"</span>)</span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> var_type_dict.get(<span class="st">'continuous'</span>, []):</span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a>        series <span class="op">=</span> df[col].dropna()</span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(series) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-596"><a href="#cb40-596" aria-hidden="true" tabindex="-1"></a>        mean, std <span class="op">=</span> series.mean(), series.std()</span>
<span id="cb40-597"><a href="#cb40-597" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> std <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((series <span class="op">-</span> mean) <span class="op">/</span> std)</span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> (z_scores <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">sum</span>()</span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a>            outliers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-602"><a href="#cb40-602" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-603"><a href="#cb40-603" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> outliers <span class="op">/</span> <span class="bu">len</span>(series)</span>
<span id="cb40-604"><a href="#cb40-604" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-605"><a href="#cb40-605" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: extreme values: </span><span class="sc">{</span>outliers<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a>                <span class="st">'column'</span>: col, <span class="st">'type'</span>: <span class="st">'continuous'</span>, </span>
<span id="cb40-610"><a href="#cb40-610" aria-hidden="true" tabindex="-1"></a>                <span class="st">'issue'</span>: <span class="st">'extreme_outlier'</span>,</span>
<span id="cb40-611"><a href="#cb40-611" aria-hidden="true" tabindex="-1"></a>                <span class="st">'count'</span>: outliers, <span class="st">'pct'</span>: outlier_pct</span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb40-615"><a href="#cb40-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-616"><a href="#cb40-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variable types</span></span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a>var_types <span class="op">=</span> {</span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a>    <span class="st">'binary'</span>: [</span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Daytime/evening attendance"</span>, <span class="st">"Educational special needs"</span>, </span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gender"</span>, <span class="st">"Scholarship holder"</span>, <span class="st">"Displaced"</span>, <span class="st">"Debtor"</span>, <span class="st">"International"</span></span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nominal'</span>: [<span class="st">"Course"</span>, <span class="st">"Nacionality"</span>],</span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ordinal'</span>: [</span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Marital Status"</span>, <span class="st">"Application mode"</span>, <span class="st">"Application order"</span>,</span>
<span id="cb40-625"><a href="#cb40-625" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Previous qualification"</span>, <span class="st">"Mother's qualification"</span>, </span>
<span id="cb40-626"><a href="#cb40-626" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Father's qualification"</span>, <span class="st">"Mother's occupation"</span>, <span class="st">"Father's occupation"</span></span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grades'</span>: [</span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Previous qualification (grade)"</span>, <span class="st">"Admission grade"</span>,</span>
<span id="cb40-630"><a href="#cb40-630" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 1st sem (grade)"</span>, <span class="st">"Curricular units 2nd sem (grade)"</span></span>
<span id="cb40-631"><a href="#cb40-631" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a>    <span class="st">'counts'</span>: [</span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 1st sem (enrolled)"</span>,</span>
<span id="cb40-634"><a href="#cb40-634" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Curricular units 2nd sem (enrolled)"</span></span>
<span id="cb40-635"><a href="#cb40-635" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a>    <span class="st">'continuous'</span>: [<span class="st">"Age at enrollment"</span>, <span class="st">"Unemployment rate"</span>, <span class="st">"Inflation rate"</span>, <span class="st">"GDP"</span>]</span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a><span class="co"># Run outlier detection</span></span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a>outlier_results <span class="op">=</span> detect_outliers_intelligent(df, var_types)</span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.5 - Outlier Summary</span></span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: outlier-summary</span></span>
<span id="cb40-649"><a href="#cb40-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-650"><a href="#cb40-650" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> outlier_results.empty:</span>
<span id="cb40-651"><a href="#cb40-651" aria-hidden="true" tabindex="-1"></a>    outlier_results <span class="op">=</span> outlier_results.sort_values(<span class="st">'pct'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Detected Issues:"</span>)</span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a>    outlier_results</span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visualize problematic variables</span></span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> outlier_results.iterrows():</span>
<span id="cb40-657"><a href="#cb40-657" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> row[<span class="st">'column'</span>]</span>
<span id="cb40-658"><a href="#cb40-658" aria-hidden="true" tabindex="-1"></a>        fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Histogram</span></span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a>        df[col].hist(bins<span class="op">=</span><span class="dv">30</span>, ax<span class="op">=</span>ax1, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a>        ax1.set_title(<span class="ss">f"Distribution"</span>)</span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a>        ax1.set_xlabel(col)</span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a>        ax1.set_ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a>        ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Boxplot</span></span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(y<span class="op">=</span>df[col], ax<span class="op">=</span>ax2)</span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a>        ax2.set_title(<span class="ss">f"Boxplot (</span><span class="sc">{</span>row[<span class="st">'type'</span>]<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a>        ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a>        plt.suptitle(<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>row[<span class="st">'count'</span>]<span class="sc">}</span><span class="ss"> potential outliers (</span><span class="sc">{</span>row[<span class="st">'pct'</span>]<span class="sc">:.1f}</span><span class="ss">%)"</span>, </span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ No significant outliers detected!"</span>)</span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a>We identified outliers in five different variables.</span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a>Curricular units 1st semester (enrolled) and Curricular units 2nd semester (enrolled), which represent the number of courses students register for each semester. We observed 106 potential outliers in the first curricularsemester and 82 in the second semester. Since the average course load is usually 5 to 6 classes, students taking a much higher or lower number of courses are naturally flagged as outliers. In the first semester, the highest value reaches 26 classes. Although this is an ambitious workload, it remains possible. Several situations could explain such a high number: for instance, a student trying to complete their degree quickly, or a student retaking courses after previous failures. These cases can reflect meaningful academic behaviours, so removing them would risk losing useful information. For the second semester, the maximum value is around 20 classes, leading to similar conclusions. In both semesters, we also observe students enrolled in zero courses, which appears as an extreme value as well. This may correspond to students who completed most of their required courses earlier, or students taking a temporary break while still being officially enrolled. These profiles are still relevant and should be included. In this context, these extreme values are not problematic. On the contrary, they may help us understand whether taking unusually many, or unusually few, courses has an impact on college dropout. For this reason, we decided not to remove or cap these observations.</span>
<span id="cb40-682"><a href="#cb40-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-683"><a href="#cb40-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a>The next variable with detected outliers is Age at enrollment, for which 101 potential outliers were identified. Since the average age at enrollment is around 20 years old, students beginning their studies at 40 or 50 naturally appear as unusual cases. The oldest student is 70 years old, which is uncommon but not problematic for our analysis. Starting university at 70 does not change the fact that this person is a student, and these cases should be included. These values represent real and meaningful student profiles, such as mature students or individuals returning to education after a long break. Excluding them would remove important diversity from the dataset and limit our understanding of the different types of students who may or may not drop out. For this reason, we chose not to remove or cap the age-related outliers.</span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a>Finally, outliers were also detected in Admission grade (22 cases) and Previous qualification grade (21 cases). These extreme values reflect either exceptionally high academic performance or, conversely, unusually low grades. Since these cases may provide insights into how prior academic achievement relates to dropout behavior, removing or capping them would not be appropriate. We therefore opted to retain all outliers in these grade variables as well.</span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a>Based on our research questions, we conclude that removing these outliers would not benefit our analysis, as they do not represent errors but rather uncommon yet meaningful observations. Retaining them allows us to capture the full diversity of student profiles and provides a more accurate understanding of the factors that may influence college dropout.</span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.6 - Feature Importance Analysis</span></span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-691"><a href="#cb40-691" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.1 - Methodology</span></span>
<span id="cb40-692"><a href="#cb40-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-693"><a href="#cb40-693" aria-hidden="true" tabindex="-1"></a>We used one-way ANOVA (Analysis of Variance) to identify which numeric variables show significant differences across the three target groups (Dropout, Enrolled, Graduate). For each variable, we calculated:</span>
<span id="cb40-694"><a href="#cb40-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-695"><a href="#cb40-695" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**p-value**: Statistical significance of differences between groups (α = 0.05)</span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Eta-squared (η²)**: Effect size measure representing the proportion of variance explained by the target variable (ranges from 0 to 1, where higher values indicate stronger association)</span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a>Variables with p-value &lt; 0.05 are considered significantly associated with student outcomes and may be strong predictors in classification models.</span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-702"><a href="#cb40-702" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-703"><a href="#cb40-703" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: anova-analysis</span></span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-705"><a href="#cb40-705" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA for numeric variables</span></span>
<span id="cb40-706"><a href="#cb40-706" aria-hidden="true" tabindex="-1"></a>anova_results <span class="op">=</span> {}</span>
<span id="cb40-707"><a href="#cb40-707" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>np.number).columns</span>
<span id="cb40-708"><a href="#cb40-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-709"><a href="#cb40-709" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb40-710"><a href="#cb40-710" aria-hidden="true" tabindex="-1"></a>    groups <span class="op">=</span> [df.loc[df[target_col] <span class="op">==</span> cat, col].dropna()</span>
<span id="cb40-711"><a href="#cb40-711" aria-hidden="true" tabindex="-1"></a>              <span class="cf">for</span> cat <span class="kw">in</span> df[target_col].cat.categories</span>
<span id="cb40-712"><a href="#cb40-712" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> cat <span class="kw">in</span> df[target_col].unique()]</span>
<span id="cb40-713"><a href="#cb40-713" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-714"><a href="#cb40-714" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Need at least 2 non-empty groups</span></span>
<span id="cb40-715"><a href="#cb40-715" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(<span class="bu">len</span>(g) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> g <span class="kw">in</span> groups) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb40-716"><a href="#cb40-716" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb40-717"><a href="#cb40-717" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-718"><a href="#cb40-718" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> scipy.stats <span class="im">import</span> f_oneway</span>
<span id="cb40-719"><a href="#cb40-719" aria-hidden="true" tabindex="-1"></a>    f_val, p_val <span class="op">=</span> f_oneway(<span class="op">*</span>groups)</span>
<span id="cb40-720"><a href="#cb40-720" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-721"><a href="#cb40-721" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Effect size: eta-squared</span></span>
<span id="cb40-722"><a href="#cb40-722" aria-hidden="true" tabindex="-1"></a>    grand_mean <span class="op">=</span> df[col].mean()</span>
<span id="cb40-723"><a href="#cb40-723" aria-hidden="true" tabindex="-1"></a>    ss_between <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">len</span>(g) <span class="op">*</span> (g.mean() <span class="op">-</span> grand_mean) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> g <span class="kw">in</span> groups)</span>
<span id="cb40-724"><a href="#cb40-724" aria-hidden="true" tabindex="-1"></a>    ss_total <span class="op">=</span> ((df[col] <span class="op">-</span> grand_mean) <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb40-725"><a href="#cb40-725" aria-hidden="true" tabindex="-1"></a>    eta_sq <span class="op">=</span> ss_between <span class="op">/</span> ss_total <span class="cf">if</span> ss_total <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb40-726"><a href="#cb40-726" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-727"><a href="#cb40-727" aria-hidden="true" tabindex="-1"></a>    anova_results[col] <span class="op">=</span> {<span class="st">"p_value"</span>: p_val, <span class="st">"eta_sq"</span>: eta_sq}</span>
<span id="cb40-728"><a href="#cb40-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-729"><a href="#cb40-729" aria-hidden="true" tabindex="-1"></a><span class="co"># Create results dataframe</span></span>
<span id="cb40-730"><a href="#cb40-730" aria-hidden="true" tabindex="-1"></a>anova_df <span class="op">=</span> (pd.DataFrame(anova_results).T</span>
<span id="cb40-731"><a href="#cb40-731" aria-hidden="true" tabindex="-1"></a>            .sort_values([<span class="st">"p_value"</span>, <span class="st">"eta_sq"</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>]))</span>
<span id="cb40-732"><a href="#cb40-732" aria-hidden="true" tabindex="-1"></a>anova_df[<span class="st">"significant"</span>] <span class="op">=</span> anova_df[<span class="st">"p_value"</span>] <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb40-733"><a href="#cb40-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-734"><a href="#cb40-734" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significant variables (p &lt; 0.05): </span><span class="sc">{</span>anova_df[<span class="st">'significant'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-735"><a href="#cb40-735" aria-hidden="true" tabindex="-1"></a>anova_df.head(<span class="dv">15</span>)</span>
<span id="cb40-736"><a href="#cb40-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-737"><a href="#cb40-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-738"><a href="#cb40-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.7 - Top Predictive Variables</span></span>
<span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-740"><a href="#cb40-740" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.7.1 - Acadamic Performance Indicators</span></span>
<span id="cb40-741"><a href="#cb40-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-742"><a href="#cb40-742" aria-hidden="true" tabindex="-1"></a>Our exploratory analysis shows clear and consistent relationships between academic performance measures and student outcomes (Dropout, Enrolled, Graduate). Several patterns emerge across admission grades, semester performance, and course load.</span>
<span id="cb40-743"><a href="#cb40-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-746"><a href="#cb40-746" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-747"><a href="#cb40-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-admission-grade</span></span>
<span id="cb40-748"><a href="#cb40-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Admission grade by student outcome"</span></span>
<span id="cb40-749"><a href="#cb40-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-750"><a href="#cb40-750" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-751"><a href="#cb40-751" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-752"><a href="#cb40-752" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-753"><a href="#cb40-753" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Admission grade'</span>,</span>
<span id="cb40-754"><a href="#cb40-754" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-755"><a href="#cb40-755" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-756"><a href="#cb40-756" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-757"><a href="#cb40-757" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Admission grade by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-758"><a href="#cb40-758" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-759"><a href="#cb40-759" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-760"><a href="#cb40-760" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-761"><a href="#cb40-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-762"><a href="#cb40-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-763"><a href="#cb40-763" aria-hidden="true" tabindex="-1"></a>Students who graduate generally start with higher admission grades than those who drop out, while enrolled students sit in between. Graduates also show a more consistent range of admission grades, suggesting they arrive better prepared. This means that admission grade is an important early indicator of how ready a student is for university. Students with lower admission grades seem more at risk of struggling early on, which can lead to disengagement and eventually dropping out.</span>
<span id="cb40-764"><a href="#cb40-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-767"><a href="#cb40-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-768"><a href="#cb40-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-prev-qual-grade</span></span>
<span id="cb40-769"><a href="#cb40-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Previous qualification grade by student outcome"</span></span>
<span id="cb40-770"><a href="#cb40-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-771"><a href="#cb40-771" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-772"><a href="#cb40-772" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-773"><a href="#cb40-773" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-774"><a href="#cb40-774" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Previous qualification (grade)'</span>,</span>
<span id="cb40-775"><a href="#cb40-775" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-776"><a href="#cb40-776" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-777"><a href="#cb40-777" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-778"><a href="#cb40-778" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Previous qualification (grade) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-779"><a href="#cb40-779" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-780"><a href="#cb40-780" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-781"><a href="#cb40-781" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-782"><a href="#cb40-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-783"><a href="#cb40-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-784"><a href="#cb40-784" aria-hidden="true" tabindex="-1"></a>See @fig-prev-qual-grade for details.</span>
<span id="cb40-785"><a href="#cb40-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-788"><a href="#cb40-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-789"><a href="#cb40-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-st-sem-grade</span></span>
<span id="cb40-790"><a href="#cb40-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "First semester grade by student outcome"</span></span>
<span id="cb40-791"><a href="#cb40-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-792"><a href="#cb40-792" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-793"><a href="#cb40-793" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-794"><a href="#cb40-794" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-795"><a href="#cb40-795" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 1st sem (grade)'</span>,</span>
<span id="cb40-796"><a href="#cb40-796" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-797"><a href="#cb40-797" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-798"><a href="#cb40-798" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-799"><a href="#cb40-799" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 1st sem (grade) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-800"><a href="#cb40-800" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-801"><a href="#cb40-801" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-802"><a href="#cb40-802" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-803"><a href="#cb40-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-804"><a href="#cb40-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-805"><a href="#cb40-805" aria-hidden="true" tabindex="-1"></a>First-semester grades are the strongest indicator of student performance in the whole dataset. Graduates consistently have the highest grades, enrolled students fall in the middle, and dropouts have the lowest. </span>
<span id="cb40-806"><a href="#cb40-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-809"><a href="#cb40-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-810"><a href="#cb40-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-grades</span></span>
<span id="cb40-811"><a href="#cb40-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot of Grades by Target"</span></span>
<span id="cb40-812"><a href="#cb40-812" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-813"><a href="#cb40-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-814"><a href="#cb40-814" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-815"><a href="#cb40-815" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-816"><a href="#cb40-816" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 2nd sem (grade)'</span>,</span>
<span id="cb40-817"><a href="#cb40-817" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-818"><a href="#cb40-818" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-819"><a href="#cb40-819" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-820"><a href="#cb40-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-821"><a href="#cb40-821" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Curricular units 2nd sem (grade) by </span><span class="sc">{</span>target_col<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-822"><a href="#cb40-822" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-823"><a href="#cb40-823" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-824"><a href="#cb40-824" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-825"><a href="#cb40-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-826"><a href="#cb40-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-827"><a href="#cb40-827" aria-hidden="true" tabindex="-1"></a>Second-semester grades show the same trend, though the differences between groups become slightly smaller once first-semester results are considered. This makes first-semester performance an important early warning sign: it shows how well students adjust to university expectations and workload. Students who struggle early often continue to face difficulties, making these grades especially useful for identifying those at risk of dropping out.</span>
<span id="cb40-828"><a href="#cb40-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-831"><a href="#cb40-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-832"><a href="#cb40-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-1st-sem-enrolled</span></span>
<span id="cb40-833"><a href="#cb40-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "First semester enrollment by student outcome"</span></span>
<span id="cb40-834"><a href="#cb40-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-835"><a href="#cb40-835" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-836"><a href="#cb40-836" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-837"><a href="#cb40-837" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-838"><a href="#cb40-838" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 1st sem (enrolled)'</span>,</span>
<span id="cb40-839"><a href="#cb40-839" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-840"><a href="#cb40-840" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-842"><a href="#cb40-842" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 1st sem (enrolled) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-843"><a href="#cb40-843" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-844"><a href="#cb40-844" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-845"><a href="#cb40-845" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-846"><a href="#cb40-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-847"><a href="#cb40-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-848"><a href="#cb40-848" aria-hidden="true" tabindex="-1"></a>Students who graduate tend to enroll in more first-semester courses compared with those who drop out, while enrolled students fall between the two groups. Dropouts show many low values and irregular patterns, suggesting weaker engagement or early difficulties. Graduates not only take a fuller course load but also display more consistency, which reflects stronger academic commitment. Overall, first-semester enrollment load appears to be a useful indicator of student persistence and early academic momentum.</span>
<span id="cb40-849"><a href="#cb40-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-852"><a href="#cb40-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-853"><a href="#cb40-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-2nd-sem-enrolled</span></span>
<span id="cb40-854"><a href="#cb40-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Second semester enrollment by student outcome"</span></span>
<span id="cb40-855"><a href="#cb40-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-856"><a href="#cb40-856" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-857"><a href="#cb40-857" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-858"><a href="#cb40-858" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-859"><a href="#cb40-859" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Curricular units 2nd sem (enrolled)'</span>,</span>
<span id="cb40-860"><a href="#cb40-860" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-861"><a href="#cb40-861" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-862"><a href="#cb40-862" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-863"><a href="#cb40-863" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curricular units 2nd sem (enrolled) by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-864"><a href="#cb40-864" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-865"><a href="#cb40-865" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-866"><a href="#cb40-866" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-867"><a href="#cb40-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-868"><a href="#cb40-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-869"><a href="#cb40-869" aria-hidden="true" tabindex="-1"></a>In the second semester, the same general pattern seen in the first semester remains: graduates enroll in more curricular units, enrolled students sit in the middle, and dropouts take the fewest. </span>
<span id="cb40-870"><a href="#cb40-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-871"><a href="#cb40-871" aria-hidden="true" tabindex="-1"></a>However, the differences between groups are less pronounced compared to the first semester. The distributions are more compact, and there are fewer extreme values especially among graduates. Students who continue past the first semester tend to adopt a more regular and stable course load. </span>
<span id="cb40-872"><a href="#cb40-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-875"><a href="#cb40-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-876"><a href="#cb40-876" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-daytime-evening</span></span>
<span id="cb40-877"><a href="#cb40-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Daytime/evening attendance by student outcome"</span></span>
<span id="cb40-878"><a href="#cb40-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-879"><a href="#cb40-879" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Daytime/evening attendance'</span>])</span>
<span id="cb40-880"><a href="#cb40-880" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb40-881"><a href="#cb40-881" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb40-882"><a href="#cb40-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-883"><a href="#cb40-883" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-884"><a href="#cb40-884" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-885"><a href="#cb40-885" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb40-886"><a href="#cb40-886" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Daytime/evening attendance by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-887"><a href="#cb40-887" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Attendance'</span>, labels<span class="op">=</span>[<span class="st">'Evening'</span>, <span class="st">'Daytime'</span>],</span>
<span id="cb40-888"><a href="#cb40-888" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb40-889"><a href="#cb40-889" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-890"><a href="#cb40-890" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-891"><a href="#cb40-891" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-892"><a href="#cb40-892" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-893"><a href="#cb40-893" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-894"><a href="#cb40-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-895"><a href="#cb40-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-896"><a href="#cb40-896" aria-hidden="true" tabindex="-1"></a>See @fig-daytime-evening for details.</span>
<span id="cb40-897"><a href="#cb40-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-900"><a href="#cb40-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-901"><a href="#cb40-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-application-order</span></span>
<span id="cb40-902"><a href="#cb40-902" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Application order by student outcome"</span></span>
<span id="cb40-903"><a href="#cb40-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-904"><a href="#cb40-904" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-905"><a href="#cb40-905" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-906"><a href="#cb40-906" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-907"><a href="#cb40-907" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Application order'</span>,</span>
<span id="cb40-908"><a href="#cb40-908" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-909"><a href="#cb40-909" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-910"><a href="#cb40-910" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-911"><a href="#cb40-911" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Application order by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-912"><a href="#cb40-912" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-913"><a href="#cb40-913" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-914"><a href="#cb40-914" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-915"><a href="#cb40-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-916"><a href="#cb40-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-917"><a href="#cb40-917" aria-hidden="true" tabindex="-1"></a>See @fig-application-order for details.</span>
<span id="cb40-918"><a href="#cb40-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-921"><a href="#cb40-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-922"><a href="#cb40-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-displaced</span></span>
<span id="cb40-923"><a href="#cb40-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Displaced status by student outcome"</span></span>
<span id="cb40-924"><a href="#cb40-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-925"><a href="#cb40-925" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Displaced'</span>])</span>
<span id="cb40-926"><a href="#cb40-926" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb40-927"><a href="#cb40-927" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb40-928"><a href="#cb40-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-929"><a href="#cb40-929" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-930"><a href="#cb40-930" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-931"><a href="#cb40-931" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb40-932"><a href="#cb40-932" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Displaced by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-933"><a href="#cb40-933" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Displaced'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>],</span>
<span id="cb40-934"><a href="#cb40-934" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb40-935"><a href="#cb40-935" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-936"><a href="#cb40-936" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-937"><a href="#cb40-937" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-938"><a href="#cb40-938" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-939"><a href="#cb40-939" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-940"><a href="#cb40-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-941"><a href="#cb40-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-942"><a href="#cb40-942" aria-hidden="true" tabindex="-1"></a>See @fig-displaced for details.</span>
<span id="cb40-943"><a href="#cb40-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-944"><a href="#cb40-944" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.7.2 - Key Findings: Academic Performance and Study Conditions</span></span>
<span id="cb40-945"><a href="#cb40-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-946"><a href="#cb40-946" aria-hidden="true" tabindex="-1"></a>**Academic Performance Impact:**</span>
<span id="cb40-947"><a href="#cb40-947" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Students who graduate have significantly higher admission grades (mean: X) compared to dropouts (mean: Y)</span>
<span id="cb40-948"><a href="#cb40-948" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>First semester grades show the strongest association with outcomes (η² = X), suggesting early academic performance is a critical indicator</span>
<span id="cb40-949"><a href="#cb40-949" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Approved course units in semester 1 differentiate graduates from dropouts more than enrollment numbers</span>
<span id="cb40-950"><a href="#cb40-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-951"><a href="#cb40-951" aria-hidden="true" tabindex="-1"></a>**Study Conditions Impact:**</span>
<span id="cb40-952"><a href="#cb40-952" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Daytime students show X% higher graduation rates compared to evening students</span>
<span id="cb40-953"><a href="#cb40-953" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Application mode significantly affects outcomes (χ² = X, p &lt; 0.001), with <span class="co">[</span><span class="ot">specific mode</span><span class="co">]</span> showing highest graduation rates</span>
<span id="cb40-954"><a href="#cb40-954" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Course type is significantly associated with dropout risk, with <span class="co">[</span><span class="ot">specific courses</span><span class="co">]</span> showing higher retention</span>
<span id="cb40-955"><a href="#cb40-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-956"><a href="#cb40-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-957"><a href="#cb40-957" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.7.3 Demographic &amp; Socioeconomic Background</span></span>
<span id="cb40-958"><a href="#cb40-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-959"><a href="#cb40-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-962"><a href="#cb40-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-963"><a href="#cb40-963" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-age</span></span>
<span id="cb40-964"><a href="#cb40-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Age at enrollment by student outcome"</span></span>
<span id="cb40-965"><a href="#cb40-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-966"><a href="#cb40-966" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-967"><a href="#cb40-967" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-968"><a href="#cb40-968" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-969"><a href="#cb40-969" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Age at enrollment'</span>,</span>
<span id="cb40-970"><a href="#cb40-970" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-971"><a href="#cb40-971" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-972"><a href="#cb40-972" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-973"><a href="#cb40-973" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Age at enrollment by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-974"><a href="#cb40-974" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-975"><a href="#cb40-975" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-976"><a href="#cb40-976" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-977"><a href="#cb40-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-978"><a href="#cb40-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-979"><a href="#cb40-979" aria-hidden="true" tabindex="-1"></a>See @fig-age for details.</span>
<span id="cb40-980"><a href="#cb40-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-983"><a href="#cb40-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-984"><a href="#cb40-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gender</span></span>
<span id="cb40-985"><a href="#cb40-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Gender by student outcome"</span></span>
<span id="cb40-986"><a href="#cb40-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-987"><a href="#cb40-987" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Gender'</span>])</span>
<span id="cb40-988"><a href="#cb40-988" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb40-989"><a href="#cb40-989" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb40-990"><a href="#cb40-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-991"><a href="#cb40-991" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-992"><a href="#cb40-992" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-993"><a href="#cb40-993" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb40-994"><a href="#cb40-994" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gender by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-995"><a href="#cb40-995" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Gender'</span>, labels<span class="op">=</span>[<span class="st">'Female'</span>, <span class="st">'Male'</span>],</span>
<span id="cb40-996"><a href="#cb40-996" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb40-997"><a href="#cb40-997" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-998"><a href="#cb40-998" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-999"><a href="#cb40-999" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-1000"><a href="#cb40-1000" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1001"><a href="#cb40-1001" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1002"><a href="#cb40-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-1003"><a href="#cb40-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1004"><a href="#cb40-1004" aria-hidden="true" tabindex="-1"></a>See @fig-gender for details.</span>
<span id="cb40-1005"><a href="#cb40-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1008"><a href="#cb40-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-1009"><a href="#cb40-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scholarship</span></span>
<span id="cb40-1010"><a href="#cb40-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scholarship holder status by student outcome"</span></span>
<span id="cb40-1011"><a href="#cb40-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1012"><a href="#cb40-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.figure(figsize=(8, 5))</span></span>
<span id="cb40-1013"><a href="#cb40-1013" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Scholarship holder'</span>])</span>
<span id="cb40-1014"><a href="#cb40-1014" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb40-1015"><a href="#cb40-1015" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb40-1016"><a href="#cb40-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1017"><a href="#cb40-1017" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb40-1018"><a href="#cb40-1018" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-1019"><a href="#cb40-1019" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb40-1020"><a href="#cb40-1020" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scholarship holder by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-1021"><a href="#cb40-1021" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Scholarship holder'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>], </span>
<span id="cb40-1022"><a href="#cb40-1022" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb40-1023"><a href="#cb40-1023" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-1024"><a href="#cb40-1024" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-1025"><a href="#cb40-1025" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-1026"><a href="#cb40-1026" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1027"><a href="#cb40-1027" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1028"><a href="#cb40-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-1029"><a href="#cb40-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1030"><a href="#cb40-1030" aria-hidden="true" tabindex="-1"></a>See @fig-scholarship for details.</span>
<span id="cb40-1031"><a href="#cb40-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1034"><a href="#cb40-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-1035"><a href="#cb40-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-debtor</span></span>
<span id="cb40-1036"><a href="#cb40-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Debtor status by student outcome"</span></span>
<span id="cb40-1037"><a href="#cb40-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1038"><a href="#cb40-1038" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> (pd.crosstab(df[target_col], df[<span class="st">'Debtor'</span>])</span>
<span id="cb40-1039"><a href="#cb40-1039" aria-hidden="true" tabindex="-1"></a>       .<span class="bu">apply</span>(<span class="kw">lambda</span> r: r <span class="op">/</span> r.<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb40-1040"><a href="#cb40-1040" aria-hidden="true" tabindex="-1"></a>tab <span class="op">=</span> tab.reindex(columns<span class="op">=</span><span class="bu">sorted</span>(tab.columns.tolist()))</span>
<span id="cb40-1041"><a href="#cb40-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1042"><a href="#cb40-1042" aria-hidden="true" tabindex="-1"></a>tab.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-1043"><a href="#cb40-1043" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>], edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb40-1044"><a href="#cb40-1044" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion within target group"</span>)</span>
<span id="cb40-1045"><a href="#cb40-1045" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Debtor by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-1046"><a href="#cb40-1046" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Debtor'</span>, labels<span class="op">=</span>[<span class="st">'No'</span>, <span class="st">'Yes'</span>],</span>
<span id="cb40-1047"><a href="#cb40-1047" aria-hidden="true" tabindex="-1"></a>         bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb40-1048"><a href="#cb40-1048" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-1049"><a href="#cb40-1049" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-1050"><a href="#cb40-1050" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-1051"><a href="#cb40-1051" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1052"><a href="#cb40-1052" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1053"><a href="#cb40-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-1054"><a href="#cb40-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1055"><a href="#cb40-1055" aria-hidden="true" tabindex="-1"></a>See @fig-debtor for details.</span>
<span id="cb40-1056"><a href="#cb40-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1057"><a href="#cb40-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1060"><a href="#cb40-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-1061"><a href="#cb40-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-marital-status</span></span>
<span id="cb40-1062"><a href="#cb40-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Marital status by student outcome"</span></span>
<span id="cb40-1063"><a href="#cb40-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1064"><a href="#cb40-1064" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-1065"><a href="#cb40-1065" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-1066"><a href="#cb40-1066" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-1067"><a href="#cb40-1067" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Marital Status'</span>,</span>
<span id="cb40-1068"><a href="#cb40-1068" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-1069"><a href="#cb40-1069" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-1070"><a href="#cb40-1070" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-1071"><a href="#cb40-1071" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Marital Status by Target'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-1072"><a href="#cb40-1072" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-1073"><a href="#cb40-1073" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1074"><a href="#cb40-1074" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1075"><a href="#cb40-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-1076"><a href="#cb40-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1077"><a href="#cb40-1077" aria-hidden="true" tabindex="-1"></a>See @fig-marital-status for details.</span>
<span id="cb40-1078"><a href="#cb40-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1081"><a href="#cb40-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-1082"><a href="#cb40-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mother-qualification</span></span>
<span id="cb40-1083"><a href="#cb40-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Mother's qualification by student outcome"</span></span>
<span id="cb40-1084"><a href="#cb40-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1085"><a href="#cb40-1085" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-1086"><a href="#cb40-1086" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb40-1087"><a href="#cb40-1087" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>target_col,</span>
<span id="cb40-1088"><a href="#cb40-1088" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Mother's qualification"</span>,</span>
<span id="cb40-1089"><a href="#cb40-1089" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,</span>
<span id="cb40-1090"><a href="#cb40-1090" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span>[<span class="st">'#e74c3c'</span>, <span class="st">'#f39c12'</span>, <span class="st">'#2ecc71'</span>]</span>
<span id="cb40-1091"><a href="#cb40-1091" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-1092"><a href="#cb40-1092" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Mother's qualification by Target"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb40-1093"><a href="#cb40-1093" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb40-1094"><a href="#cb40-1094" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1095"><a href="#cb40-1095" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1096"><a href="#cb40-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-1097"><a href="#cb40-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1098"><a href="#cb40-1098" aria-hidden="true" tabindex="-1"></a>See @fig-mother-qualification for details.</span>
<span id="cb40-1099"><a href="#cb40-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1100"><a href="#cb40-1100" aria-hidden="true" tabindex="-1"></a>4.7.2 - Key Findings: Demographic &amp; Socioeconomic Background </span>
<span id="cb40-1101"><a href="#cb40-1101" aria-hidden="true" tabindex="-1"></a>....</span>
<span id="cb40-1102"><a href="#cb40-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1103"><a href="#cb40-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8 - Predictive Modelling</span></span>
<span id="cb40-1104"><a href="#cb40-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1107"><a href="#cb40-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-1108"><a href="#cb40-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: classification-model</span></span>
<span id="cb40-1109"><a href="#cb40-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1110"><a href="#cb40-1110" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-1111"><a href="#cb40-1111" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb40-1112"><a href="#cb40-1112" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb40-1113"><a href="#cb40-1113" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb40-1114"><a href="#cb40-1114" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb40-1115"><a href="#cb40-1115" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, accuracy_score</span>
<span id="cb40-1116"><a href="#cb40-1116" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime</span>
<span id="cb40-1117"><a href="#cb40-1117" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime.lime_tabular</span>
<span id="cb40-1118"><a href="#cb40-1118" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-1119"><a href="#cb40-1119" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb40-1120"><a href="#cb40-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1121"><a href="#cb40-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the dataframe after feature selection (columns already removed)</span></span>
<span id="cb40-1122"><a href="#cb40-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># This df already has the 8 redundant columns removed</span></span>
<span id="cb40-1123"><a href="#cb40-1123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Starting with </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> features (after feature selection)"</span>)</span>
<span id="cb40-1124"><a href="#cb40-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1125"><a href="#cb40-1125" aria-hidden="true" tabindex="-1"></a><span class="co"># Create working dataframe - use all columns that exist</span></span>
<span id="cb40-1126"><a href="#cb40-1126" aria-hidden="true" tabindex="-1"></a>df_model <span class="op">=</span> df.copy()</span>
<span id="cb40-1127"><a href="#cb40-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1128"><a href="#cb40-1128" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb40-1129"><a href="#cb40-1129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape before cleaning: </span><span class="sc">{</span>df_model<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1130"><a href="#cb40-1130" aria-hidden="true" tabindex="-1"></a>df_model <span class="op">=</span> df_model.dropna()</span>
<span id="cb40-1131"><a href="#cb40-1131" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape after removing missing values: </span><span class="sc">{</span>df_model<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1132"><a href="#cb40-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1133"><a href="#cb40-1133" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Target distribution:"</span>)</span>
<span id="cb40-1134"><a href="#cb40-1134" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_model[<span class="st">'Target'</span>].value_counts())</span>
<span id="cb40-1135"><a href="#cb40-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1136"><a href="#cb40-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and target</span></span>
<span id="cb40-1137"><a href="#cb40-1137" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_model.drop(<span class="st">'Target'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-1138"><a href="#cb40-1138" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_model[<span class="st">'Target'</span>]</span>
<span id="cb40-1139"><a href="#cb40-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1140"><a href="#cb40-1140" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Using </span><span class="sc">{</span>X<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> features for classification"</span>)</span>
<span id="cb40-1141"><a href="#cb40-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1142"><a href="#cb40-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables</span></span>
<span id="cb40-1143"><a href="#cb40-1143" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>, <span class="st">'category'</span>]).columns</span>
<span id="cb40-1144"><a href="#cb40-1144" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb40-1145"><a href="#cb40-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1146"><a href="#cb40-1146" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🔄 Encoding </span><span class="sc">{</span><span class="bu">len</span>(categorical_cols)<span class="sc">}</span><span class="ss"> categorical variables..."</span>)</span>
<span id="cb40-1147"><a href="#cb40-1147" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb40-1148"><a href="#cb40-1148" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb40-1149"><a href="#cb40-1149" aria-hidden="true" tabindex="-1"></a>    X[col] <span class="op">=</span> le.fit_transform(X[col].astype(<span class="bu">str</span>))</span>
<span id="cb40-1150"><a href="#cb40-1150" aria-hidden="true" tabindex="-1"></a>    label_encoders[col] <span class="op">=</span> le</span>
<span id="cb40-1151"><a href="#cb40-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1152"><a href="#cb40-1152" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb40-1153"><a href="#cb40-1153" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb40-1154"><a href="#cb40-1154" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb40-1155"><a href="#cb40-1155" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-1156"><a href="#cb40-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1157"><a href="#cb40-1157" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Training set size: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1158"><a href="#cb40-1158" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test set size: </span><span class="sc">{</span>X_test<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1159"><a href="#cb40-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1160"><a href="#cb40-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest model</span></span>
<span id="cb40-1161"><a href="#cb40-1161" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🌲 Training Random Forest Classifier..."</span>)</span>
<span id="cb40-1162"><a href="#cb40-1162" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb40-1163"><a href="#cb40-1163" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb40-1164"><a href="#cb40-1164" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb40-1165"><a href="#cb40-1165" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb40-1166"><a href="#cb40-1166" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb40-1167"><a href="#cb40-1167" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-1168"><a href="#cb40-1168" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span>
<span id="cb40-1169"><a href="#cb40-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1170"><a href="#cb40-1170" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb40-1171"><a href="#cb40-1171" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> rf_model.predict(X_test)</span>
<span id="cb40-1172"><a href="#cb40-1172" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> rf_model.predict_proba(X_test)</span>
<span id="cb40-1173"><a href="#cb40-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1174"><a href="#cb40-1174" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate model</span></span>
<span id="cb40-1175"><a href="#cb40-1175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Model Performance:"</span>)</span>
<span id="cb40-1176"><a href="#cb40-1176" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb40-1177"><a href="#cb40-1177" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Classification Report:"</span>)</span>
<span id="cb40-1178"><a href="#cb40-1178" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb40-1179"><a href="#cb40-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1180"><a href="#cb40-1180" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb40-1181"><a href="#cb40-1181" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb40-1182"><a href="#cb40-1182" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb40-1183"><a href="#cb40-1183" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>)</span>
<span id="cb40-1184"><a href="#cb40-1184" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Confusion Matrix'</span>)</span>
<span id="cb40-1185"><a href="#cb40-1185" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Label'</span>)</span>
<span id="cb40-1186"><a href="#cb40-1186" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Label'</span>)</span>
<span id="cb40-1187"><a href="#cb40-1187" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1188"><a href="#cb40-1188" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1189"><a href="#cb40-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1190"><a href="#cb40-1190" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Importance from Random Forest</span></span>
<span id="cb40-1191"><a href="#cb40-1191" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb40-1192"><a href="#cb40-1192" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: X.columns,</span>
<span id="cb40-1193"><a href="#cb40-1193" aria-hidden="true" tabindex="-1"></a>    <span class="st">'importance'</span>: rf_model.feature_importances_</span>
<span id="cb40-1194"><a href="#cb40-1194" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-1195"><a href="#cb40-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1196"><a href="#cb40-1196" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔍 Top 15 Most Important Features (Random Forest):"</span>)</span>
<span id="cb40-1197"><a href="#cb40-1197" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head(<span class="dv">15</span>))</span>
<span id="cb40-1198"><a href="#cb40-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1199"><a href="#cb40-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot feature importance</span></span>
<span id="cb40-1200"><a href="#cb40-1200" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb40-1201"><a href="#cb40-1201" aria-hidden="true" tabindex="-1"></a>top_15 <span class="op">=</span> feature_importance.head(<span class="dv">15</span>)</span>
<span id="cb40-1202"><a href="#cb40-1202" aria-hidden="true" tabindex="-1"></a>plt.barh(<span class="bu">range</span>(<span class="bu">len</span>(top_15)), top_15[<span class="st">'importance'</span>])</span>
<span id="cb40-1203"><a href="#cb40-1203" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(top_15)), top_15[<span class="st">'feature'</span>])</span>
<span id="cb40-1204"><a href="#cb40-1204" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Importance'</span>)</span>
<span id="cb40-1205"><a href="#cb40-1205" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 15 Feature Importance (Random Forest)'</span>)</span>
<span id="cb40-1206"><a href="#cb40-1206" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb40-1207"><a href="#cb40-1207" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1208"><a href="#cb40-1208" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1209"><a href="#cb40-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1210"><a href="#cb40-1210" aria-hidden="true" tabindex="-1"></a><span class="co"># LIME Explainer</span></span>
<span id="cb40-1211"><a href="#cb40-1211" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔬 Setting up LIME explainer..."</span>)</span>
<span id="cb40-1212"><a href="#cb40-1212" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> lime.lime_tabular.LimeTabularExplainer(</span>
<span id="cb40-1213"><a href="#cb40-1213" aria-hidden="true" tabindex="-1"></a>    training_data<span class="op">=</span>X_train.values,</span>
<span id="cb40-1214"><a href="#cb40-1214" aria-hidden="true" tabindex="-1"></a>    feature_names<span class="op">=</span>X.columns.tolist(),</span>
<span id="cb40-1215"><a href="#cb40-1215" aria-hidden="true" tabindex="-1"></a>    class_names<span class="op">=</span>[<span class="bu">str</span>(c) <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">sorted</span>(y.unique())],</span>
<span id="cb40-1216"><a href="#cb40-1216" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'classification'</span>,</span>
<span id="cb40-1217"><a href="#cb40-1217" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb40-1218"><a href="#cb40-1218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-1219"><a href="#cb40-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1220"><a href="#cb40-1220" aria-hidden="true" tabindex="-1"></a><span class="co"># Explain a few predictions</span></span>
<span id="cb40-1221"><a href="#cb40-1221" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">💡 LIME Explanations for Sample Predictions:"</span>)</span>
<span id="cb40-1222"><a href="#cb40-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1223"><a href="#cb40-1223" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 3 random test samples</span></span>
<span id="cb40-1224"><a href="#cb40-1224" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb40-1225"><a href="#cb40-1225" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="op">=</span> np.random.choice(X_test.index, size<span class="op">=</span><span class="bu">min</span>(<span class="dv">3</span>, <span class="bu">len</span>(X_test)), replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-1226"><a href="#cb40-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1227"><a href="#cb40-1227" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, sample_idx <span class="kw">in</span> <span class="bu">enumerate</span>(sample_indices):</span>
<span id="cb40-1228"><a href="#cb40-1228" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> X_test.loc[sample_idx].values</span>
<span id="cb40-1229"><a href="#cb40-1229" aria-hidden="true" tabindex="-1"></a>    true_label <span class="op">=</span> y_test.loc[sample_idx]</span>
<span id="cb40-1230"><a href="#cb40-1230" aria-hidden="true" tabindex="-1"></a>    pred_label <span class="op">=</span> rf_model.predict([sample])[<span class="dv">0</span>]</span>
<span id="cb40-1231"><a href="#cb40-1231" aria-hidden="true" tabindex="-1"></a>    pred_proba <span class="op">=</span> rf_model.predict_proba([sample])[<span class="dv">0</span>]</span>
<span id="cb40-1232"><a href="#cb40-1232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-1233"><a href="#cb40-1233" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- Sample </span><span class="sc">{</span>idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> ---"</span>)</span>
<span id="cb40-1234"><a href="#cb40-1234" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"True Label: </span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1235"><a href="#cb40-1235" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Predicted Label: </span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1236"><a href="#cb40-1236" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Prediction Probability: </span><span class="sc">{</span>pred_proba<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-1237"><a href="#cb40-1237" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-1238"><a href="#cb40-1238" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate LIME explanation</span></span>
<span id="cb40-1239"><a href="#cb40-1239" aria-hidden="true" tabindex="-1"></a>    exp <span class="op">=</span> explainer.explain_instance(</span>
<span id="cb40-1240"><a href="#cb40-1240" aria-hidden="true" tabindex="-1"></a>        sample,</span>
<span id="cb40-1241"><a href="#cb40-1241" aria-hidden="true" tabindex="-1"></a>        rf_model.predict_proba,</span>
<span id="cb40-1242"><a href="#cb40-1242" aria-hidden="true" tabindex="-1"></a>        num_features<span class="op">=</span><span class="dv">10</span></span>
<span id="cb40-1243"><a href="#cb40-1243" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-1244"><a href="#cb40-1244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-1245"><a href="#cb40-1245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show explanation</span></span>
<span id="cb40-1246"><a href="#cb40-1246" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top 10 features influencing this prediction:"</span>)</span>
<span id="cb40-1247"><a href="#cb40-1247" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature, weight <span class="kw">in</span> exp.as_list():</span>
<span id="cb40-1248"><a href="#cb40-1248" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>weight<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb40-1249"><a href="#cb40-1249" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-1250"><a href="#cb40-1250" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot explanation</span></span>
<span id="cb40-1251"><a href="#cb40-1251" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> exp.as_pyplot_figure()</span>
<span id="cb40-1252"><a href="#cb40-1252" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb40-1253"><a href="#cb40-1253" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb40-1254"><a href="#cb40-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1255"><a href="#cb40-1255" aria-hidden="true" tabindex="-1"></a><span class="co"># Global feature importance from LIME (sample-based)</span></span>
<span id="cb40-1256"><a href="#cb40-1256" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📈 Computing global LIME feature importance (sampling 100 instances)..."</span>)</span>
<span id="cb40-1257"><a href="#cb40-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1258"><a href="#cb40-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample instances for global importance</span></span>
<span id="cb40-1259"><a href="#cb40-1259" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="bu">min</span>(<span class="dv">100</span>, <span class="bu">len</span>(X_test))</span>
<span id="cb40-1260"><a href="#cb40-1260" aria-hidden="true" tabindex="-1"></a>sample_indices_global <span class="op">=</span> np.random.choice(<span class="bu">len</span>(X_test), size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-1261"><a href="#cb40-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1262"><a href="#cb40-1262" aria-hidden="true" tabindex="-1"></a>lime_weights <span class="op">=</span> {feature: [] <span class="cf">for</span> feature <span class="kw">in</span> X.columns}</span>
<span id="cb40-1263"><a href="#cb40-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1264"><a href="#cb40-1264" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> sample_indices_global:</span>
<span id="cb40-1265"><a href="#cb40-1265" aria-hidden="true" tabindex="-1"></a>    exp <span class="op">=</span> explainer.explain_instance(</span>
<span id="cb40-1266"><a href="#cb40-1266" aria-hidden="true" tabindex="-1"></a>        X_test.iloc[i].values,</span>
<span id="cb40-1267"><a href="#cb40-1267" aria-hidden="true" tabindex="-1"></a>        rf_model.predict_proba,</span>
<span id="cb40-1268"><a href="#cb40-1268" aria-hidden="true" tabindex="-1"></a>        num_features<span class="op">=</span><span class="bu">len</span>(X.columns)</span>
<span id="cb40-1269"><a href="#cb40-1269" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-1270"><a href="#cb40-1270" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-1271"><a href="#cb40-1271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature, weight <span class="kw">in</span> exp.as_list():</span>
<span id="cb40-1272"><a href="#cb40-1272" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract feature name (LIME returns feature with value range)</span></span>
<span id="cb40-1273"><a href="#cb40-1273" aria-hidden="true" tabindex="-1"></a>        feature_name <span class="op">=</span> feature.split(<span class="st">'&lt;='</span>)[<span class="dv">0</span>].split(<span class="st">'&gt;'</span>)[<span class="dv">0</span>].split(<span class="st">'='</span>)[<span class="dv">0</span>].strip()</span>
<span id="cb40-1274"><a href="#cb40-1274" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find matching column (partial match)</span></span>
<span id="cb40-1275"><a href="#cb40-1275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> X.columns:</span>
<span id="cb40-1276"><a href="#cb40-1276" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> col <span class="kw">in</span> feature_name <span class="kw">or</span> feature_name <span class="kw">in</span> col:</span>
<span id="cb40-1277"><a href="#cb40-1277" aria-hidden="true" tabindex="-1"></a>                lime_weights[col].append(<span class="bu">abs</span>(weight))</span>
<span id="cb40-1278"><a href="#cb40-1278" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb40-1279"><a href="#cb40-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1280"><a href="#cb40-1280" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute average absolute weight for each feature</span></span>
<span id="cb40-1281"><a href="#cb40-1281" aria-hidden="true" tabindex="-1"></a>lime_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb40-1282"><a href="#cb40-1282" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: <span class="bu">list</span>(lime_weights.keys()),</span>
<span id="cb40-1283"><a href="#cb40-1283" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lime_importance'</span>: [np.mean(weights) <span class="cf">if</span> weights <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> weights <span class="kw">in</span> lime_weights.values()]</span>
<span id="cb40-1284"><a href="#cb40-1284" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'lime_importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-1285"><a href="#cb40-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1286"><a href="#cb40-1286" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">🔍 Top 15 Most Important Features (LIME Global):"</span>)</span>
<span id="cb40-1287"><a href="#cb40-1287" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lime_importance.head(<span class="dv">15</span>))</span>
<span id="cb40-1288"><a href="#cb40-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1289"><a href="#cb40-1289" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Random Forest vs LIME importance</span></span>
<span id="cb40-1290"><a href="#cb40-1290" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb40-1291"><a href="#cb40-1291" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> feature_importance.merge(lime_importance, on<span class="op">=</span><span class="st">'feature'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb40-1292"><a href="#cb40-1292" aria-hidden="true" tabindex="-1"></a>comparison[<span class="st">'lime_importance'</span>] <span class="op">=</span> comparison[<span class="st">'lime_importance'</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb40-1293"><a href="#cb40-1293" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> comparison.nlargest(<span class="dv">15</span>, <span class="st">'importance'</span>)</span>
<span id="cb40-1294"><a href="#cb40-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1295"><a href="#cb40-1295" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(top_features))</span>
<span id="cb40-1296"><a href="#cb40-1296" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb40-1297"><a href="#cb40-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1298"><a href="#cb40-1298" aria-hidden="true" tabindex="-1"></a>plt.barh(x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, top_features[<span class="st">'importance'</span>], width, label<span class="op">=</span><span class="st">'Random Forest'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb40-1299"><a href="#cb40-1299" aria-hidden="true" tabindex="-1"></a>plt.barh(x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, top_features[<span class="st">'lime_importance'</span>], width, label<span class="op">=</span><span class="st">'LIME'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb40-1300"><a href="#cb40-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1301"><a href="#cb40-1301" aria-hidden="true" tabindex="-1"></a>plt.yticks(x, top_features[<span class="st">'feature'</span>])</span>
<span id="cb40-1302"><a href="#cb40-1302" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Importance Score'</span>)</span>
<span id="cb40-1303"><a href="#cb40-1303" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Importance Comparison: Random Forest vs LIME'</span>)</span>
<span id="cb40-1304"><a href="#cb40-1304" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb40-1305"><a href="#cb40-1305" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb40-1306"><a href="#cb40-1306" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-1307"><a href="#cb40-1307" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-1308"><a href="#cb40-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1309"><a href="#cb40-1309" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ Classification and LIME analysis complete!"</span>)</span>
<span id="cb40-1310"><a href="#cb40-1310" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Final model uses </span><span class="sc">{</span><span class="bu">len</span>(X.columns)<span class="sc">}</span><span class="ss"> features to predict student outcomes."</span>)</span>
<span id="cb40-1311"><a href="#cb40-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>